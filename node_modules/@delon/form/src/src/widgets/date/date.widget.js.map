{"version":3,"file":"date.widget.js","sourceRoot":"","sources":["../../../../../../../packages/form/src/widgets/date/date.widget.ts"],"names":[],"mappings":";;;;;AAAA,OAAO,EAAE,SAAS,EAAU,MAAM,eAAe,CAAC;AAClD,OAAO,EAAE,aAAa,EAAE,MAAM,cAAc,CAAC;AAC7C,OAAO,KAAK,MAAM,MAAM,iBAAiB,CAAC;AAE1C,qBAAM,UAAU,GAAG;IACjB,WAAW,EAAE,sBAAsB;CACpC,CAAC;AAEF,qBAAM,aAAa,GAAG,qBAAqB,CAAC;;IAqBZ,sCAAa;;;;;;;IAK3C,6BAAQ;;;IAAR;QACE,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,KAAK,WAAW,CAAC,CAAC,CAAC,gBAAgB,CAAC,CAAC,CAAC,MAAM,CAAC;QAC3E,IAAI,CAAC,MAAM;YACT,CAAC,IAAI,CAAC,EAAE,UAAO,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM;gBACnC,CAAC,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,YAAY;gBAChD,CAAC,CAAC,IAAI,CAAC,EAAE,UAAO,CAAC;KACtB;;;;;IAED,0BAAK;;;;IAAL,UAAM,KAAU;QACd,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;KAC3B;;;;;;IAEO,+BAAU;;;;;cAAC,KAAa,EAAE,YAAoB;QACpD,MAAM,CAAC,MAAM,CAAC,KAAK,EAAE,YAAY,EAAE,EAAE,MAAM,EAAE,mBAAC,MAAa,EAAC,CAAC,UAAU,EAAE,CAAC,CAAC;;;;;;IAGrE,kCAAa;;;;cAAC,KAAU;;;;;;;;IAKhC,4BAAO;;;;IAAP,UAAQ,KAAa;QACnB,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAC1B,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,IAAI,aAAa,CAAC,CAAC,CAAC;KACrE;;gBAhDF,SAAS,SAAC;oBACT,QAAQ,EAAE,SAAS;oBACnB,QAAQ,EAAE,mcAcT;oBACD,mBAAmB,EAAE,KAAK;iBAC3B;;qBA5BD;EA6BgC,aAAa;SAAhC,UAAU","sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { ControlWidget } from '../../widget';\r\nimport * as format from 'date-fns/format';\r\n\r\nconst DATEFORMAT = {\r\n  'date-time': `YYYY-MM-DDTHH:mm:ssZ`,\r\n};\r\n\r\nconst DEFAULTFORMAT = 'YYYY-MM-DD HH:mm:ss';\r\n\r\n@Component({\r\n  selector: 'sf-date',\r\n  template: `\r\n  <sf-item-wrap [id]=\"id\" [schema]=\"schema\" [ui]=\"ui\" [showError]=\"showError\" [error]=\"error\" [showTitle]=\"schema.title\">\r\n\r\n    <input nz-input\r\n      [attr.id]=\"id\"\r\n      [disabled]=\"disabled\"\r\n      [nzSize]=\"ui.size\"\r\n      [value]=\"displayValue\"\r\n      (input)=\"_change($event.target?.value)\"\r\n      [attr.type]=\"type\"\r\n      [attr.placeholder]=\"ui.placeholder\"\r\n      autocomplete=\"off\">\r\n\r\n  </sf-item-wrap>\r\n  `,\r\n  preserveWhitespaces: false,\r\n})\r\nexport class DateWidget extends ControlWidget implements OnInit {\r\n  type: string;\r\n  displayValue: string;\r\n  format: string;\r\n\r\n  ngOnInit(): void {\r\n    this.type = this.schema.format === 'date-time' ? 'datetime-local' : 'date';\r\n    this.format =\r\n      !this.ui.format && this.schema.format\r\n        ? DATEFORMAT[this.schema.format] || 'YYYY-MM-DD'\r\n        : this.ui.format;\r\n  }\r\n\r\n  reset(value: any) {\r\n    this.formatDisplay(value);\r\n  }\r\n\r\n  private formatData(value: string, formatString: string) {\r\n    return format(value, formatString, { locale: (window as any).__locale__ });\r\n  }\r\n\r\n  private formatDisplay(value: any) {\r\n    // TODO：HTML 原生日期组件无法按 `displayFormat` 格式，暂时停用以下代码\r\n    // this.displayValue = this.formatData(value, this.ui.displayFormat || DEFAULTFORMAT);\r\n  }\r\n\r\n  _change(value: string) {\r\n    this.formatDisplay(value);\r\n    this.setValue(this.formatData(value, this.format || DEFAULTFORMAT));\r\n  }\r\n}\r\n"]}