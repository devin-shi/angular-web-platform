{"version":3,"file":"select.widget.js","sourceRoot":"","sources":["../../../../../../../packages/form/src/widgets/select/select.widget.ts"],"names":[],"mappings":";;;;;AAAA,OAAO,EAAE,SAAS,EAAU,MAAM,eAAe,CAAC;AAClD,OAAO,EAAE,aAAa,EAAE,MAAM,cAAc,CAAC;AAE7C,OAAO,EAAE,OAAO,EAAE,MAAM,aAAa,CAAC;;IAiDJ,wCAAa;;;yBAGlC,KAAK;;;;;;IAEhB,+BAAQ;;;IAAR;QACE,IAAI,CAAC,CAAC,GAAG;YACP,UAAU,EAAE,IAAI,CAAC,EAAE,cAAW;YAC9B,SAAS,EAAE,IAAI,CAAC,EAAE,iBAAc,KAAK;YACrC,iBAAiB,EAAE,IAAI,CAAC,EAAE,yBAAsB,IAAI;YACpD,wBAAwB,EAAE,IAAI,CAAC,EAAE,gCAA6B,IAAI;YAClE,YAAY,EAAE,IAAI,CAAC,EAAE,oBAAiB,KAAK;YAC3C,gBAAgB,EAAE,IAAI,CAAC,EAAE,wBAAqB,QAAQ;YACtD,IAAI,EAAE,IAAI,CAAC,EAAE,YAAS,SAAS;YAC/B,eAAe,EAAE,IAAI,CAAC,EAAE,uBAAoB,MAAM;YAClD,UAAU,EAAE,IAAI,CAAC,EAAE,kBAAe,IAAI;SACvC,CAAC;KACH;;;;;IAED,4BAAK;;;;IAAL,UAAM,KAAU;QAAhB,iBAQC;QAPC,OAAO,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC,SAAS,CACjE,UAAA,IAAI;YACF,KAAI,CAAC,IAAI,GAAG,IAAI,CAAC;YACjB,KAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,KAAK,KAAK,IAAI,EAAhB,CAAgB,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC;YAC9D,KAAI,CAAC,aAAa,EAAE,CAAC;SACtB,CACF,CAAC;KACH;;;;;IAED,iCAAU;;;;IAAV,UAAW,KAAU;QACnB,EAAE,CAAC,CAAC,IAAI,CAAC,EAAE;YAAa,IAAI,CAAC,EAAE,eAAY,KAAK,CAAC,CAAC;KACnD;;;;;IAED,mCAAY;;;;IAAZ,UAAa,IAAY;QAAzB,iBASC;QARC,EAAE,CAAC,CAAC,IAAI,CAAC,EAAE,cAAW,CAAC;YACrB,IAAI,CAAC,EAAE,aAAU,IAAI,CAAC,CAAC,IAAI,CAAC,UAAC,GAAU;gBACrC,KAAI,CAAC,IAAI,GAAG,GAAG,CAAC;gBAChB,KAAI,CAAC,aAAa,EAAE,CAAC;aACtB,CAAC,CAAC;YACH,MAAM,CAAC;SACR;QACD,IAAI,CAAC,aAAa,EAAE,CAAC;KACtB;;;;;IAED,qCAAc;;;;IAAd,UAAe,KAAU;QACvB,EAAE,CAAC,CAAC,IAAI,CAAC,EAAE;YAAiB,IAAI,CAAC,EAAE,mBAAgB,KAAK,CAAC,CAAC;KAC3D;;gBA7FF,SAAS,SAAC;oBACT,QAAQ,EAAE,WAAW;oBACrB,QAAQ,EAAE,kgDA0CT;oBACD,mBAAmB,EAAE,KAAK;iBAC3B;;uBAnDD;EAoDkC,aAAa;SAAlC,YAAY","sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { ControlWidget } from '../../widget';\r\nimport { SFSchemaEnum } from '../../schema';\r\nimport { getData } from '../../utils';\r\n\r\n@Component({\r\n  selector: 'sf-select',\r\n  template: `\r\n  <sf-item-wrap [id]=\"id\" [schema]=\"schema\" [ui]=\"ui\" [showError]=\"showError\" [error]=\"error\" [showTitle]=\"schema.title\">\r\n\r\n    <nz-select\r\n      [nzDisabled]=\"disabled\"\r\n      [nzSize]=\"ui.size\"\r\n      [ngModel]=\"value\"\r\n      (ngModelChange)=\"setValue($event)\"\r\n      [nzPlaceHolder]=\"ui.placeholder\"\r\n      [nzAllowClear]=\"i.allowClear\"\r\n      [nzAutoFocus]=\"i.autoFocus\"\r\n      [nzDropdownClassName]=\"i.dropdownClassName\"\r\n      [nzDropdownMatchSelectWidth]=\"i.dropdownMatchSelectWidth\"\r\n      [nzServerSearch]=\"i.serverSearch\"\r\n      [nzMaxMultipleCount]=\"i.maxMultipleCount\"\r\n      [nzMode]=\"i.mode\"\r\n      [nzNotFoundContent]=\"i.notFoundContent\"\r\n      [nzShowSearch]=\"i.showSearch\"\r\n      (nzOpenChange)=\"openChange($event)\"\r\n      (nzOnSearch)=\"searchChange($event)\"\r\n      (nzScrollToBottom)=\"scrollToBottom($event)\">\r\n      <ng-container *ngIf=\"!hasGroup\">\r\n        <nz-option\r\n          *ngFor=\"let o of data\"\r\n          [nzLabel]=\"o.label\"\r\n          [nzValue]=\"o.value\"\r\n          [nzDisabled]=\"o.disabled\">\r\n        </nz-option>\r\n      </ng-container>\r\n      <ng-container *ngIf=\"hasGroup\">\r\n        <nz-option-group *ngFor=\"let i of data\" [nzLabel]=\"i.label\">\r\n          <nz-option\r\n            *ngFor=\"let o of i.children\"\r\n            [nzLabel]=\"o.label\"\r\n            [nzValue]=\"o.value\"\r\n            [nzDisabled]=\"o.disabled\">\r\n          </nz-option>\r\n        </nz-option-group>\r\n      </ng-container>\r\n    </nz-select>\r\n\r\n  </sf-item-wrap>\r\n  `,\r\n  preserveWhitespaces: false,\r\n})\r\nexport class SelectWidget extends ControlWidget implements OnInit {\r\n  i: any;\r\n  data: SFSchemaEnum[];\r\n  hasGroup = false;\r\n\r\n  ngOnInit(): void {\r\n    this.i = {\r\n      allowClear: this.ui.allowClear,\r\n      autoFocus: this.ui.autoFocus || false,\r\n      dropdownClassName: this.ui.dropdownClassName || null,\r\n      dropdownMatchSelectWidth: this.ui.dropdownMatchSelectWidth || true,\r\n      serverSearch: this.ui.serverSearch || false,\r\n      maxMultipleCount: this.ui.maxMultipleCount || Infinity,\r\n      mode: this.ui.mode || 'default',\r\n      notFoundContent: this.ui.notFoundContent || '无法找到',\r\n      showSearch: this.ui.showSearch || true,\r\n    };\r\n  }\r\n\r\n  reset(value: any) {\r\n    getData(this.schema, this.ui, this.formProperty.formData).subscribe(\r\n      list => {\r\n        this.data = list;\r\n        this.hasGroup = list.filter(w => w.group === true).length > 0;\r\n        this.detectChanges();\r\n      },\r\n    );\r\n  }\r\n\r\n  openChange(value: any) {\r\n    if (this.ui.openChange) this.ui.openChange(value);\r\n  }\r\n\r\n  searchChange(text: string) {\r\n    if (this.ui.onSearch) {\r\n      this.ui.onSearch(text).then((res: any[]) => {\r\n        this.data = res;\r\n        this.detectChanges();\r\n      });\r\n      return;\r\n    }\r\n    this.detectChanges();\r\n  }\r\n\r\n  scrollToBottom(value: any) {\r\n    if (this.ui.scrollToBottom) this.ui.scrollToBottom(value);\r\n  }\r\n}\r\n"]}