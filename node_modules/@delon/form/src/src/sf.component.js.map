{"version":3,"file":"sf.component.js","sourceRoot":"","sources":["../../../../../packages/form/src/sf.component.ts"],"names":[],"mappings":"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","sourcesContent":["import {\r\n  Component,\r\n  OnInit,\r\n  OnChanges,\r\n  OnDestroy,\r\n  SimpleChanges,\r\n  Input,\r\n  SimpleChange,\r\n  Output,\r\n  EventEmitter,\r\n  TemplateRef,\r\n  ChangeDetectionStrategy,\r\n  ChangeDetectorRef,\r\n} from '@angular/core';\r\nimport { coerceBooleanProperty } from '@angular/cdk/coercion';\r\nimport { deepCopy } from '@delon/util';\r\n\r\nimport { DelonFormConfig } from './config';\r\nimport { di, retrieveSchema, FORMATMAPS, resolveIf } from './utils';\r\nimport { TerminatorService } from './terminator.service';\r\nimport { SFSchema } from './schema/index';\r\nimport {\r\n  SFUISchema,\r\n  SFUISchemaItem,\r\n  SFRenderSchema,\r\n  SFUISchemaItemRun,\r\n} from './schema/ui';\r\nimport { FormProperty } from './model/form.property';\r\nimport { FormPropertyFactory } from './model/form.property.factory';\r\nimport { SchemaValidatorFactory } from './validator.factory';\r\nimport { WidgetFactory } from './widget.factory';\r\nimport { SFButton } from './interface';\r\nimport { ErrorData } from './errors';\r\n\r\nexport function useFactory(\r\n  schemaValidatorFactory: any,\r\n  options: DelonFormConfig,\r\n) {\r\n  return new FormPropertyFactory(schemaValidatorFactory, options);\r\n}\r\n\r\n@Component({\r\n  selector: 'sf, [sf]',\r\n  template: `\r\n  <ng-template #con><ng-content></ng-content></ng-template>\r\n  <form nz-form [nzLayout]=\"layout\" (submit)=\"onSubmit($event)\" [attr.autocomplete]=\"autocomplete\">\r\n    <sf-item [formProperty]=\"rootProperty\"></sf-item>\r\n    <ng-container *ngIf=\"button !== 'none'; else con\">\r\n      <nz-form-item [ngClass]=\"_btn.render.class\" class=\"sf-btns\" [fixed-label]=\"_btn.render.spanLabelFixed\">\r\n        <nz-col class=\"ant-form-item-control-wrapper\"\r\n          [nzSpan]=\"_btn.render.grid.span\" [nzOffset]=\"_btn.render.grid.offset\"\r\n          [nzXs]=\"_btn.render.grid.xs\" [nzSm]=\"_btn.render.grid.sm\" [nzMd]=\"_btn.render.grid.md\"\r\n          [nzLg]=\"_btn.render.grid.lg\" [nzXl]=\"_btn.render.grid.xl\">\r\n          <div class=\"ant-form-item-control\">\r\n            <ng-container *ngIf=\"button; else con\">\r\n              <button type=\"submit\" nz-button [nzType]=\"_btn.submit_type\" [disabled]=\"liveValidate && !valid\">{{_btn.submit}}</button>\r\n              <button *ngIf=\"_btn.reset\" (click)=\"reset()\" type=\"button\" nz-button [nzType]=\"_btn.reset_type\">{{_btn.reset}}</button>\r\n            </ng-container>\r\n          </div>\r\n        </nz-col>\r\n      </nz-form-item>\r\n    </ng-container>\r\n  </form>`,\r\n  providers: [\r\n    WidgetFactory,\r\n    {\r\n      provide: FormPropertyFactory,\r\n      useFactory: useFactory,\r\n      deps: [SchemaValidatorFactory, DelonFormConfig],\r\n    },\r\n    TerminatorService,\r\n  ],\r\n  host: {\r\n    '[class.sf]': 'true',\r\n    '[class.sf-search]': `mode === 'search'`,\r\n    '[class.sf-edit]': `mode === 'edit'`,\r\n  },\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class SFComponent implements OnInit, OnChanges, OnDestroy {\r\n  rootProperty: FormProperty = null;\r\n  _formData: any;\r\n  _btn: SFButton;\r\n  _schema: SFSchema;\r\n  _ui: SFUISchema;\r\n  private _item: any;\r\n  private _valid = true;\r\n  private _defUi: SFUISchemaItem;\r\n  private _inited = false;\r\n\r\n  // region: fields\r\n\r\n  /** 表单布局，等同 `nzLayout`，默认：horizontal */\r\n  @Input() layout: 'horizontal' | 'vertical' | 'inline' = 'horizontal';\r\n\r\n  /** JSON Schema */\r\n  @Input() schema: SFSchema;\r\n\r\n  /** UI Schema */\r\n  @Input() ui: SFUISchema;\r\n\r\n  /** 表单默认值 */\r\n  @Input() formData: {};\r\n\r\n  /**\r\n   * 按钮\r\n   * - 值为 `null` 或 `undefined` 表示手动添加按钮，但保留容器\r\n   * - 值为 `none` 表示手动添加按钮，且不保留容器\r\n   * - 使用固定 `label` 标签宽度时，若无 `render.class` 则默认为居中状态\r\n   */\r\n  @Input() button: SFButton | 'none' = {};\r\n\r\n  /**\r\n   * 是否实时校验，默认：`true`\r\n   * - `true` 每一次都校验\r\n   * - `false` 提交时校验\r\n   */\r\n  @Input()\r\n  get liveValidate() {\r\n    return this._liveValidate;\r\n  }\r\n  set liveValidate(value: any) {\r\n    this._liveValidate = coerceBooleanProperty(value);\r\n  }\r\n  private _liveValidate = true;\r\n\r\n  /** 指定表单 `autocomplete` 值 */\r\n  @Input() autocomplete: 'on' | 'off';\r\n\r\n  /** 立即显示错误视觉 */\r\n  @Input()\r\n  get firstVisual() {\r\n    return this._firstVisual;\r\n  }\r\n  set firstVisual(value: any) {\r\n    this._firstVisual = coerceBooleanProperty(value);\r\n  }\r\n  private _firstVisual = true;\r\n\r\n  /** 表单模式 */\r\n  @Input()\r\n  set mode(value: 'default' | 'search' | 'edit') {\r\n    switch (value) {\r\n      case 'search':\r\n        this.layout = 'inline';\r\n        this.firstVisual = false;\r\n        this.liveValidate = false;\r\n        if (this._btn) this._btn.submit = '搜索';\r\n        break;\r\n      case 'edit':\r\n        this.layout = 'horizontal';\r\n        this.firstVisual = false;\r\n        this.liveValidate = true;\r\n        if (this._btn) this._btn.submit = '保存';\r\n        break;\r\n    }\r\n    this._mode = value;\r\n  }\r\n  get mode() {\r\n    return this._mode;\r\n  }\r\n  private _mode: 'default' | 'search' | 'edit';\r\n\r\n  /** 数据变更时回调 */\r\n  @Output() formChange = new EventEmitter<{}>();\r\n\r\n  /** 提交表单时回调 */\r\n  @Output() formSubmit = new EventEmitter<{}>();\r\n\r\n  /** 重置表单时回调 */\r\n  @Output() formReset = new EventEmitter<{}>();\r\n\r\n  /** 表单校验结果回调 */\r\n  @Output() formError = new EventEmitter<ErrorData[]>();\r\n\r\n  // endregion\r\n\r\n  /** 表单校验状态 */\r\n  get valid(): boolean {\r\n    return this._valid;\r\n  }\r\n\r\n  /** 表单值 */\r\n  get value(): any {\r\n    return this._item;\r\n  }\r\n\r\n  onSubmit(e: Event) {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    if (!this.liveValidate) this.validator();\r\n    if (!this.valid) return;\r\n    this.formSubmit.emit(this.value);\r\n  }\r\n\r\n  constructor(\r\n    private formPropertyFactory: FormPropertyFactory,\r\n    private terminator: TerminatorService,\r\n    private options: DelonFormConfig,\r\n    private cd: ChangeDetectorRef,\r\n  ) {\r\n    this.liveValidate = options.liveValidate;\r\n    this.firstVisual = options.firstVisual;\r\n    this.autocomplete = options.autocomplete;\r\n  }\r\n\r\n  private coverProperty() {\r\n    const isHorizontal = this.layout === 'horizontal';\r\n    const _schema = deepCopy(this.schema);\r\n    const { definitions } = _schema;\r\n\r\n    const inFn = (\r\n      schema: SFSchema,\r\n      parentSchema: SFSchema,\r\n      uiSchema: SFUISchemaItemRun,\r\n      parentUiSchema: SFUISchemaItemRun,\r\n      uiRes: SFUISchemaItemRun,\r\n    ) => {\r\n      Object.keys(schema.properties).forEach(key => {\r\n        const uiKey = `$${key}`;\r\n        const property = retrieveSchema(\r\n          schema.properties[key] as SFSchema,\r\n          definitions,\r\n        );\r\n        const ui = Object.assign(\r\n          { widget: property.type },\r\n          property.format && FORMATMAPS[property.format],\r\n          typeof property.ui === 'string' ? { widget: property.ui } : null,\r\n          !property.ui &&\r\n          Array.isArray(property.enum) &&\r\n          property.enum.length > 0\r\n            ? { widget: 'select' }\r\n            : null,\r\n          this._defUi,\r\n          property.ui,\r\n          uiSchema[uiKey],\r\n        ) as SFUISchemaItemRun;\r\n        // 继承父节点布局属性\r\n        if (isHorizontal) {\r\n          if (parentUiSchema.spanLabelFixed) {\r\n            if (!ui.spanLabelFixed)\r\n              ui.spanLabelFixed = parentUiSchema.spanLabelFixed;\r\n          } else {\r\n            if (!ui.spanLabel)\r\n              ui.spanLabel =\r\n                typeof parentUiSchema.spanLabel === 'undefined'\r\n                  ? 5\r\n                  : parentUiSchema.spanLabel;\r\n            if (!ui.spanControl)\r\n              ui.spanControl =\r\n                typeof parentUiSchema.spanControl === 'undefined'\r\n                  ? 19\r\n                  : parentUiSchema.spanControl;\r\n            if (!ui.offsetControl)\r\n              ui.offsetControl =\r\n                typeof parentUiSchema.offsetControl === 'undefined'\r\n                  ? null\r\n                  : parentUiSchema.offsetControl;\r\n          }\r\n        } else {\r\n          ui.spanLabel = null;\r\n          ui.spanControl = null;\r\n          ui.offsetControl = null;\r\n        }\r\n\r\n        uiRes[uiKey] = ui;\r\n        delete property.ui;\r\n\r\n        if (property.items) {\r\n          uiRes[uiKey]['$items'] = uiRes[uiKey]['$items'] || {};\r\n          inFn(\r\n            property.items,\r\n            property.items,\r\n            (uiSchema[uiKey] || {})['$items'] || {},\r\n            ui,\r\n            uiRes[uiKey]['$items'],\r\n          );\r\n        }\r\n\r\n        if (property.properties && Object.keys(property.properties).length) {\r\n          inFn(property, schema, uiSchema[uiKey] || {}, ui, uiRes[uiKey]);\r\n        }\r\n      });\r\n    };\r\n\r\n    const inIfFn = (schema: SFSchema, ui: SFUISchemaItemRun) => {\r\n      Object.keys(schema.properties).forEach(key => {\r\n        const property = schema.properties[key];\r\n        const uiKey = `$${key}`;\r\n        resolveIf(property, ui[uiKey]);\r\n        if (property.items) {\r\n          inIfFn(property.items, ui[uiKey].$items);\r\n        }\r\n        if (property.properties) {\r\n          inIfFn(property, ui[uiKey]);\r\n        }\r\n      });\r\n    };\r\n\r\n    if (this.ui == null) this.ui = {};\r\n    this._defUi = Object.assign(\r\n      <SFUISchemaItem>{\r\n        onlyVisual: this.options.onlyVisual,\r\n        size: this.options.size,\r\n        liveValidate: this.liveValidate,\r\n        firstVisual: this.firstVisual,\r\n      },\r\n      _schema.ui,\r\n      this.ui['*'],\r\n    );\r\n\r\n    // root\r\n    this._ui = Object.assign({}, this._defUi);\r\n\r\n    inFn(_schema, _schema, this.ui, this.ui, this._ui);\r\n\r\n    // cond\r\n    resolveIf(_schema, this._ui);\r\n    inIfFn(_schema, this._ui);\r\n\r\n    this._schema = _schema;\r\n\r\n    if (this._ui.debug) di('cover schema & ui', this._ui, _schema);\r\n  }\r\n\r\n  private coverButtonProperty() {\r\n    this._btn = Object.assign({ render: {} }, this.options.button, this.button);\r\n    const firstKey = Object.keys(this._ui).find(w => w.startsWith('$'));\r\n    if (this.layout === 'horizontal') {\r\n      const btnUi = firstKey ? this._ui[firstKey] : this._defUi;\r\n      if (!this._btn.render.grid) {\r\n        this._btn.render.grid = {\r\n          offset: btnUi.spanLabel,\r\n          span: btnUi.spanControl,\r\n        };\r\n      }\r\n      // fixed label\r\n      if (!this._btn.render.spanLabelFixed) {\r\n        this._btn.render.spanLabelFixed = btnUi.spanLabelFixed;\r\n      }\r\n      // 固定标签宽度时，若不指定样式，则默认居中\r\n      if (\r\n        !this._btn.render.class &&\r\n        (typeof btnUi.spanLabelFixed === 'number' && btnUi.spanLabelFixed > 0)\r\n      ) {\r\n        this._btn.render.class = 'text-center';\r\n      }\r\n    } else {\r\n      this._btn.render.grid = {};\r\n    }\r\n    if (this._mode) this.mode = this._mode;\r\n    if (this._ui.debug) di('button property', this._btn);\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this._inited = true;\r\n    this.validator();\r\n  }\r\n\r\n  ngOnChanges(\r\n    changes: { [P in keyof this]?: SimpleChange } & SimpleChanges,\r\n  ): void {\r\n    this.refreshSchema();\r\n  }\r\n\r\n  /** @internal */\r\n  _addTpl(path: string, templateRef: TemplateRef<{}>) {\r\n    const property = this.rootProperty.searchProperty(path);\r\n    if (!property) {\r\n      console.warn(`未找到路径 ${path}`);\r\n      return;\r\n    }\r\n    (property.ui as SFUISchemaItemRun)._render = templateRef;\r\n  }\r\n\r\n  private validator() {\r\n    this.rootProperty._runValidation();\r\n    const errors = this.rootProperty.errors;\r\n    this._valid = !(errors && errors.length);\r\n    this.formError.emit(errors);\r\n    this.cd.detectChanges();\r\n  }\r\n\r\n  /**\r\n   * 刷新 Schema，一般需要动态修改 Schema 某个值时可以方便调用\r\n   */\r\n  refreshSchema(newSchema?: SFSchema, newUI?: SFUISchema) {\r\n    if (newSchema) this.schema = newSchema;\r\n    if (newUI) this.ui = newUI;\r\n\r\n    if (!this.schema || typeof this.schema.properties === 'undefined')\r\n      throw new Error(`Invalid Schema`);\r\n    if (this.schema.ui && typeof this.schema.ui === 'string')\r\n      throw new Error(`Don't support string with root ui property`);\r\n\r\n    this.schema.type = 'object';\r\n\r\n    this._formData = { ...this.formData };\r\n\r\n    if (this._inited) this.terminator.destroy();\r\n\r\n    this.coverProperty();\r\n    this.coverButtonProperty();\r\n\r\n    this.rootProperty = this.formPropertyFactory.createProperty(\r\n      this._schema,\r\n      this._ui,\r\n      this.formData,\r\n    );\r\n\r\n    this.rootProperty.valueChanges.subscribe(value => {\r\n      this._item = Object.assign({}, this.formData, value);\r\n      this.formChange.emit(this._item);\r\n    });\r\n    this.rootProperty.errorsChanges.subscribe(errors => {\r\n      this._valid = !(errors && errors.length);\r\n      this.formError.emit(errors);\r\n      this.cd.detectChanges();\r\n    });\r\n\r\n    this.reset();\r\n  }\r\n\r\n  /** 重置表单 */\r\n  reset() {\r\n    this.rootProperty.resetValue(this.formData, false);\r\n    Promise.resolve().then(() => this.cd.detectChanges());\r\n    this.formReset.emit(this.value);\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.terminator.destroy();\r\n  }\r\n}\r\n"]}