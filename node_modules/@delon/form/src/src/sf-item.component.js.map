{"version":3,"file":"sf-item.component.js","sourceRoot":"","sources":["../../../../../packages/form/src/sf-item.component.ts"],"names":[],"mappings":";;;;AAAA,OAAO,EACL,SAAS,EAGT,KAAK,EACL,SAAS,EACT,gBAAgB,GAIjB,MAAM,eAAe,CAAC;AACvB,OAAO,EAAE,YAAY,EAAE,MAAM,uBAAuB,CAAC;AAErD,OAAO,EAAE,aAAa,EAAE,MAAM,kBAAkB,CAAC;AACjD,OAAO,EAAE,iBAAiB,EAAE,MAAM,sBAAsB,CAAC;AAGzD,qBAAI,YAAY,GAAG,CAAC,CAAC;;IAiBnB,YAAY;IAEZ,yBACU,eACA;QADA,kBAAa,GAAb,aAAa;QACb,eAAU,GAAV,UAAU;sBAbE,IAAI;KActB;;;;;IAEJ,8CAAoB;;;;IAApB,UAAqB,MAAmB;QACtC,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,qBAAM,EAAE,GAAG,SAAO,YAAY,EAAI,CAAC;QAEnC,qBAAM,EAAE,qBAAG,IAAI,CAAC,YAAY,CAAC,EAAoB,CAAA,CAAC;QAClD,IAAI,CAAC,MAAM,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC;QAC7C,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC;QAC9C,IAAI,CAAC,MAAM,CAAC,EAAE,GAAG,EAAE,CAAC;QACpB,IAAI,CAAC,MAAM,CAAC,EAAE,GAAG,EAAE,CAAC;QACpB,IAAI,CAAC,MAAM,CAAC,WAAW,GAAG,EAAE,CAAC,WAAW,CAAC;QACzC,IAAI,CAAC,YAAY,CAAC,MAAM,GAAG,MAAM,CAAC;KACnC;;;;IAED,kCAAQ;;;IAAR;QAAA,iBAIC;QAHC,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,SAAS,CAAC;YAClC,KAAI,CAAC,WAAW,EAAE,CAAC;SACpB,CAAC,CAAC;KACJ;;;;;IAED,qCAAW;;;;IAAX,UAAY,OAAsB;QAChC,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,aAAa,CAAC,YAAY,CACxC,IAAI,CAAC,SAAS,EACd,IAAI,CAAC,YAAY,CAAC,EAAE,cAAW,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,IAAI,CAC7D,CAAC;QACF,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;KAC9C;;;;IAED,qCAAW;;;IAAX;QACE,IAAI,CAAC,YAAY,CAAC,EAAE,gBAAa,IAAI,CAAC;QACtC,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC;KACpB;;gBApDF,SAAS,SAAC;oBACT,QAAQ,EAAE,SAAS;oBACnB,QAAQ,EAAE,qCAAqC;iBAChD;;;;gBATQ,aAAa;gBACb,iBAAiB;;;iCAevB,KAAK;8BAEL,SAAS,SAAC,QAAQ,EAAE,EAAE,IAAI,EAAE,gBAAgB,EAAE;;0BA/BjD;;SAuBa,eAAe","sourcesContent":["import {\r\n  Component,\r\n  OnInit,\r\n  OnChanges,\r\n  Input,\r\n  ViewChild,\r\n  ViewContainerRef,\r\n  ComponentRef,\r\n  OnDestroy,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { FormProperty } from './model/form.property';\r\nimport { Widget } from './widget';\r\nimport { WidgetFactory } from './widget.factory';\r\nimport { TerminatorService } from './terminator.service';\r\nimport { SFUISchemaItem } from './schema/ui';\r\n\r\nlet nextUniqueId = 0;\r\n\r\n@Component({\r\n  selector: 'sf-item',\r\n  template: `<ng-template #target></ng-template>`,\r\n})\r\nexport class SFItemComponent implements OnInit, OnChanges, OnDestroy {\r\n  private ref: ComponentRef<any>;\r\n  widget: Widget<any> = null;\r\n\r\n  // region: fields\r\n\r\n  @Input() formProperty: FormProperty;\r\n\r\n  @ViewChild('target', { read: ViewContainerRef })\r\n  container: ViewContainerRef;\r\n\r\n  // endregion\r\n\r\n  constructor(\r\n    private widgetFactory: WidgetFactory,\r\n    private terminator: TerminatorService,\r\n  ) {}\r\n\r\n  onWidgetInstanciated(widget: Widget<any>) {\r\n    this.widget = widget;\r\n    const id = `_sf-${nextUniqueId++}`;\r\n\r\n    const ui = this.formProperty.ui as SFUISchemaItem;\r\n    this.widget.formProperty = this.formProperty;\r\n    this.widget.schema = this.formProperty.schema;\r\n    this.widget.ui = ui;\r\n    this.widget.id = id;\r\n    this.widget.firstVisual = ui.firstVisual;\r\n    this.formProperty.widget = widget;\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.terminator.onDestroy.subscribe(() => {\r\n      this.ngOnDestroy();\r\n    });\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    this.ref = this.widgetFactory.createWidget(\r\n      this.container,\r\n      this.formProperty.ui.widget || this.formProperty.schema.type,\r\n    );\r\n    this.onWidgetInstanciated(this.ref.instance);\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.formProperty.ui.__destroy = true;\r\n    this.ref.destroy();\r\n  }\r\n}\r\n"]}