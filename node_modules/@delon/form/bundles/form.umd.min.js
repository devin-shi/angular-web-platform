/**
 * @license ng-alain(cipchk@qq.com) v1.0.0-beta.10
 * (c) 2018 Cipchk http://ng-alain.com/
 * License: MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/cdk/coercion"),require("@delon/util"),require("rxjs/operators"),require("rxjs/observable/of"),require("rxjs/Subject"),require("rxjs/BehaviorSubject"),require("rxjs/observable/combineLatest"),require("rxjs/Observable"),require("@angular/common"),require("@angular/forms"),require("ng-zorro-antd"),require("date-fns/format")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/cdk/coercion","@delon/util","rxjs/operators","rxjs/observable/of","rxjs/Subject","rxjs/BehaviorSubject","rxjs/observable/combineLatest","rxjs/Observable","@angular/common","@angular/forms","ng-zorro-antd","date-fns/format"],e):e((t.delon=t.delon||{},t.delon.form={}),t.ng.core,t.ng.cdk.coercion,t.delon.util,t.Rx.Observable.prototype,t.Rx.Observable,t.Rx,t.Rx,t.Rx.Observable,t.Rx,t.ng.common,t.ng.forms,t.ngZorro.antd,t["date-fns/format/index"])}(this,function(t,r,e,s,l,o,n,a,u,p,i,c,h,f){"use strict";f=f&&f.hasOwnProperty("default")?f.default:f;var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};function m(t,e){function n(){this.constructor=t}d(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var g=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t};var y={"false schema":"布尔模式出错",$ref:"无法找到引用{ref}",additionalItems:"不允许超过{ref}",additionalProperties:"不允许有额外的属性",anyOf:"数据应为 anyOf 所指定的其中一个",dependencies:"应当拥有属性{property}的依赖属性{deps}",enum:"应当是预设定的枚举值之一",format:"格式不正确",type:"类型应当是 {type}",required:"必填项",maxLength:"至多 {limit} 个字符",minLength:"至少 {limit} 个字符以上",minimum:"必须 {comparison}{limit}",formatMinimum:"必须 {comparison}{limit}",maximum:"必须 {comparison}{limit}",formatMaximum:"必须 {comparison}{limit}",maxItems:"不应多于 {limit} 个项",minItems:"不应少于 {limit} 个项",maxProperties:"不应多于 {limit} 个属性",minProperties:"不应少于 {limit} 个属性",multipleOf:"应当是 {multipleOf} 的整数倍",not:'不应当匹配 "not" schema',oneOf:'只能匹配一个 "oneOf" 中的 schema',pattern:"数据格式不正确",uniqueItems:"不应当含有重复项 (第 {j} 项与第 {i} 项是重复的)",custom:"格式不正确",propertyNames:'属性名 "{propertyName}" 无效',patternRequired:"应当有属性匹配模式 {missingPattern}",switch:'由于 {caseIndex} 失败，未通过 "switch" 校验',const:"应当等于常量",contains:"应当包含一个有效项",formatExclusiveMaximum:"formatExclusiveMaximum 应当是布尔值",formatExclusiveMinimum:"formatExclusiveMinimum 应当是布尔值",if:'应当匹配模式 "{failingKeyword}"'},b=function(){this.ingoreKeywords=["type","enum"],this.liveValidate=!0,this.autocomplete=null,this.firstVisual=!1,this.onlyVisual=!1,this.errors=y,this.button={submit:"提交",submit_type:"primary",reset:"重置",reset_type:"default"},this.uiDateStringFormat="YYYY-MM-DD HH:mm:ss",this.uiDateNumberFormat="x",this.uiTimeStringFormat="HH:mm:ss",this.uiTimeNumberFormat="x"},v={"date-time":{widget:"date"},date:{widget:"date"},"full-date":{widget:"date"},time:{widget:"time"},"full-time":{widget:"time"},week:{widget:"date"},month:{widget:"date"},uri:{widget:"upload"},email:{widget:"autocomplete",type:"email"},"":{widget:"string"}};function z(t){return null==t}function w(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];console.warn.apply(console,t)}function C(t,e){if(void 0===e&&(e={}),t.hasOwnProperty("$ref")){var n=function(t,e){void 0===e&&(e={});var n=/^#\/definitions\/(.*)$/.exec(t);if(n&&n[1]){for(var i=e,r=0,o=n[1].split("/");r<o.length;r++){var s=o[r];if(s=s.replace(/~1/g,"/").replace(/~0/g,"~"),!i.hasOwnProperty(s))throw new Error("Could not find a definition for "+t+".");i=i[s]}return i}throw new Error("Could not find a definition for "+t+".")}(t.$ref,e),i=(t.$ref,function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&(n[i[r]]=t[i[r]])}return n}(t,["$ref"]));return C(g({},n,i),e)}return t}function _(n,e){if(n.hasOwnProperty("if")&&n.hasOwnProperty("then")){if(!n.if.properties)throw new Error("if: does not contain 'properties'");var t=Object.keys(n.properties),i=Object.keys(n.if.properties);x(t,i),x(t,n.then.required),n.required=n.required.concat(n.then.required);var r=n.hasOwnProperty("else");r&&(x(t,n.else.required),n.required=n.required.concat(n.else.required));var o={},s={};return i.forEach(function(t){var e=n.if.properties[t].enum;o[t]=e,r&&(s[t]=function(t){return!e.includes(t)})}),n.then.required.forEach(function(t){return e["$"+t].visibleIf=o}),r&&n.else.required.forEach(function(t){return e["$"+t].visibleIf=s}),n}}function x(e,t){t.forEach(function(t){if(!e.includes(t))throw new Error("if: properties does not contain '"+t+"'")})}function O(t,e){return z(t)||!Array.isArray(t)||0===t.length?[]:("object"!=typeof t[0]&&(t=t.map(function(t){return{label:t,value:t}})),e&&(Array.isArray(e)||(e=[e]),t.forEach(function(t){~e.indexOf(t.value)&&(t.checked=!0)})),t)}function P(t,e){return O(s.deepCopy(t||[]),e)}function V(t,e,n,i){return"function"==typeof e.asyncData?e.asyncData(i).pipe(l.takeWhile(function(){return!0!==e.__destroy}),l.map(function(t){return O(t,n)})):o.of(P(t.enum,n))}var S=function(){function t(){this.onDestroy=new n.Subject}return t.prototype.destroy=function(){this.onDestroy.next(!0)},t}(),I=function(){function t(t,e,n,i,r,o,s){this.options=s,this._value=null,this._errors=null,this._objErrors={},this._valueChanges=new a.BehaviorSubject(null),this._errorsChanges=new a.BehaviorSubject(null),this._visible=!0,this._visibilityChanges=new a.BehaviorSubject(!0),this.schema=e,this.ui=n,this.schemaValidator=t.createValidatorFn(e,{ingoreKeywords:this.ui.ingoreKeywords}),this.formData=i||e.default,(this._parent=r)?this._root=r.root:this instanceof E&&(this._root=this),this._path=o}return Object.defineProperty(t.prototype,"valueChanges",{get:function(){return this._valueChanges},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"errorsChanges",{get:function(){return this._errorsChanges},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.schema.type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root||this},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._path},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"errors",{get:function(){return this._errors},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return this._visible},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"valid",{get:function(){return null===this._errors},enumerable:!0,configurable:!0}),t.prototype.updateValueAndValidity=function(t,e,n){void 0===t&&(t=!1),void 0===e&&(e=!0),void 0===n&&(n=!0),this._updateValue(),e&&this.valueChanges.next(this.value),n&&!0===this.ui.liveValidate&&this._runValidation(),this.parent&&!t&&this.parent.updateValueAndValidity(t,e,!1)},t.prototype.searchProperty=function(t){var e=this,n=null,i=null;if("/"===t[0])i=(n=this.findRoot()).getProperty(t.substr(1));else for(;null===i&&null!==e.parent;)e=n=e.parent,i=n.getProperty(t);return i},t.prototype.findRoot=function(){for(var t=this;null!==t.parent;)t=t.parent;return t},t.prototype._isRequired=function(t){if(!0!==this.ui._required)return!1;if(z(t))return!0;switch(this.type){case"string":return 0===(""+t).length}return!1},t.prototype._runValidation=function(){var e,n=this;e=this._isRequired(this._value)?[{keyword:"required"}]:this.schemaValidator(this._value)||[];var t=this.ui.validator;if("function"==typeof t){var i=t(this.value,this,this.findRoot());return i instanceof p.Observable?void i.subscribe(function(t){n.setCustomErrors(e,t),n.widget.detectChanges()}):void this.setCustomErrors(e,i)}this._errors=e,this.setErrors(this._errors)},t.prototype.setCustomErrors=function(t,e){null!=e&&0<e.length&&e.forEach(function(t,e){if(!t.message)throw new Error("自定义校验器必须至少返回一个 'message' 属性，用于表示错误文本");t._custom=!0}),this._errors=this.mergeErrors(t,e),this.setErrors(this._errors)},t.prototype.mergeErrors=function(t,e){return e&&(Array.isArray(e)?t=t.concat.apply(t,e):t.push(e)),t},t.prototype.setErrors=function(t,e){var i=this;void 0===e&&(e=!0),e&&t&&!this.ui.onlyVisual&&(t=t.map(function(n){var t=!0===n._custom&&n.message?n.message:(i.ui.errors||{})[n.keyword]||i.options.errors[n.keyword]||"";return t&&"function"==typeof t&&(t=t(n)),t&&(~t.indexOf("{")&&(t=t.replace(/{([\.a-z0-9]+)}/g,function(t,e){return n.params[e]||""})),n.message=t),n})),this._errors=t,this._errorsChanges.next(t),this._parent&&this._parent.setParentAndPlatErrors(t,this.path)},t.prototype.setParentAndPlatErrors=function(t,e){var n=this;this._objErrors[e]=t;var i=[];Object.keys(this._objErrors).forEach(function(t){var e=n.searchProperty(t);e&&!e.visible||i.push.apply(i,n._objErrors[t])}),this.setErrors(i,!1)},t.prototype.setVisible=function(t){this._visible=t,this._visibilityChanges.next(t)},t.prototype._bindVisibility=function(){var e=this,o=this.ui.visibleIf;if("object"==typeof o&&0===Object.keys(o).length)this.setVisible(!1);else if(void 0!==o){var s=[],t=function(n){if(o.hasOwnProperty(n)){var t=a.searchProperty(n);if(t){var e=t.valueChanges.pipe(l.map(function(t){var e=o[n];return"function"==typeof e?e(t):-1!==e.indexOf("$ANY$")?0<t.length:-1!==e.indexOf(t)})),i=t._visibilityChanges,r=u.combineLatest([e,i],function(t,e){return t&&e});s.push(r)}else console.warn("Can't find property "+n+" for visibility check of "+a.path)}},a=this;for(var n in o)t(n);u.combineLatest(s,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return-1!==t.indexOf(!0)}).pipe(l.distinctUntilChanged()).subscribe(function(t){return e.setVisible(t)})}},t}(),E=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.properties=null,t}return m(o,e),o.prototype.getProperty=function(t){var e=t.indexOf("/"),n=-1!==e?t.substr(0,e):t,i=this.properties[n];if(null!==i&&-1!==e&&i instanceof o){var r=t.substr(e+1);i=i.getProperty(r)}return i},o.prototype.forEachChild=function(t){for(var e in this.properties){if(this.properties.hasOwnProperty(e))t(this.properties[e],e)}},o.prototype.forEachChildRecursive=function(e){this.forEachChild(function(t){e(t),t instanceof o&&t.forEachChildRecursive(e)})},o.prototype._bindVisibility=function(){e.prototype._bindVisibility.call(this),this._bindVisibilityRecursive()},o.prototype._bindVisibilityRecursive=function(){this.forEachChildRecursive(function(t){t._bindVisibility()})},o.prototype.isRoot=function(){return this===this.root},o}(I),D=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.setValue=function(t,e){this._value=t,this.updateValueAndValidity(e,!0)},e.prototype.resetValue=function(t,e){null==t&&(t=void 0!==this.schema.default?this.schema.default:this.fallbackValue()),this._value=t,this.updateValueAndValidity(e,!0),this.widget&&this.widget.reset(t)},e.prototype._hasValue=function(){return this.fallbackValue()!==this.value},e.prototype._updateValue=function(){},e}(I),T=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.fallbackValue=function(){return null},e.prototype.setValue=function(t,e){"string"==typeof t&&(t=t.length?-1<t.indexOf(".")?parseFloat(t):parseInt(t,10):null),this._value=t,this.updateValueAndValidity(e,!0)},e}(D),F=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.fallbackValue=function(){return""},e}(D),M=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.fallbackValue=function(){return null},e}(D),k=function(u){function t(t,e,n,i,r,o,s,a){var l=u.call(this,e,n,i,r,o,s,a)||this;return l.formPropertyFactory=t,l.tick=1,l.properties=[],l}return m(t,u),t.prototype.getProperty=function(t){var e=t.indexOf("/"),n=+(-1!==e?t.substr(0,e):t),i=this.properties;if(!(isNaN(n)||n>=i.length)){var r=t.substr(e+1);return i[n].getProperty(r)}},t.prototype.setValue=function(t,e){this.properties=[],this.clearErrors(),this.resetProperties(t),this.updateValueAndValidity(e,!0)},t.prototype.resetValue=function(t,e){this._value=t||this.schema.default||[],this.properties=[],this.clearErrors(),this.resetProperties(this._value),this.updateValueAndValidity(e,!0)},t.prototype._hasValue=function(){return!0},t.prototype._updateValue=function(){var n=[];this.forEachChild(function(t,e){t.visible&&t._hasValue()&&n.push(Object.assign({},t.formData,t.value))}),this._value=n},t.prototype.addProperty=function(t){var e=this.formPropertyFactory.createProperty(this.schema.items,this.ui.$items,t,this);return this.properties.push(e),e},t.prototype.resetProperties=function(t){for(var e=0,n=t;e<n.length;e++){var i=n[e];this.addProperty(i).resetValue(i,!0)}},t.prototype.clearErrors=function(t){t?delete this._objErrors[t]:this._objErrors={}},t.prototype.add=function(t){void 0===t&&(t=null);var e=this.addProperty(t);return e.resetValue(t,!1),e},t.prototype.remove=function(t){var e=this.properties;this.clearErrors(e[t].path),e.splice(t,1),this.updateValueAndValidity(!1,!0)},t}(E),j=function(u){function t(t,e,n,i,r,o,s,a){var l=u.call(this,e,n,i,r,o,s,a)||this;return l.formPropertyFactory=t,l._propertiesId=[],l.createProperties(),l}return m(t,u),Object.defineProperty(t.prototype,"propertiesId",{get:function(){return this._propertiesId},enumerable:!0,configurable:!0}),t.prototype.createProperties=function(){var t,e=this;this.properties={},this._propertiesId=[];try{t=function(t,e){if(!Array.isArray(e))return t;var n=function(t){return t.reduce(function(t,e){return t[e]=!0,t},{})},i=function(t){return 1<t.length?"properties '"+t.join("', '")+"'":"property '"+t[0]+"'"},r=n(t),o=n(e),s=e.filter(function(t){return"*"!==t&&!r[t]});if(s.length)throw new Error("ui schema order list contains extraneous "+i(s));var a=t.filter(function(t){return!o[t]}),l=e.indexOf("*");if(-1===l){if(a.length)throw new Error("ui schema order list does not contain "+i(a));return e}if(l!==e.lastIndexOf("*"))throw new Error("ui schema order list contains more than one wildcard item");var u=e.slice();return u.splice.apply(u,[l,1].concat(a)),u}(Object.keys(this.schema.properties),this.ui.order)}catch(t){console.error("Invalid "+(this.schema.title||"root")+" object field configuration:",t)}t.forEach(function(t){e.schema.properties.hasOwnProperty(t)&&(e.properties[t]=e.formPropertyFactory.createProperty(e.schema.properties[t],e.ui["$"+t],(e.formData||{})[t],e,t),e._propertiesId.push(t))})},t.prototype.setValue=function(t,e){for(var n in t)t.hasOwnProperty(n)&&this.properties[n].setValue(t[n],!0);this.updateValueAndValidity(e,!0)},t.prototype.resetValue=function(t,e){for(var n in t=t||this.schema.default||{},this.schema.properties)this.schema.properties.hasOwnProperty(n)&&this.properties[n].resetValue(t[n],!0);this.updateValueAndValidity(e,!0)},t.prototype._hasValue=function(){return null!=this.value&&!!Object.keys(this.value).length},t.prototype._updateValue=function(){var n={};this.forEachChild(function(t,e){t.visible&&t._hasValue()&&(n[e]=t.value)}),this._value=n},t}(E),A=function(){function t(t,e){this.schemaValidatorFactory=t,this.options=e}return t.prototype.createProperty=function(t,e,n,i,r){void 0===i&&(i=null);var o=null,s="";if(i)if(s+=i.path,null!==i.parent&&(s+="/"),"object"===i.type)s+=r;else{if("array"!==i.type)throw new Error("Instanciation of a FormProperty with an unknown parent type: "+i.type);s+=i.tick++}else s="/";if(t.$ref){var a=C(t,i.root.schema.definitions);o=this.createProperty(a,e,n,i,s)}else switch(r&&-1!==(i.schema.required||[]).indexOf(r)&&(e._required=!0),null==t.title&&(t.title=r),"string"!==t.type&&"number"!==t.type||t.format||e.format||("date"===e.widget?e.format="string"===t.type?this.options.uiDateStringFormat:this.options.uiDateNumberFormat:"time"===e.widget&&(e.format="string"===t.type?this.options.uiTimeStringFormat:this.options.uiTimeNumberFormat)),t.type){case"integer":case"number":o=new T(this.schemaValidatorFactory,t,e,n,i,s,this.options);break;case"string":o=new F(this.schemaValidatorFactory,t,e,n,i,s,this.options);break;case"boolean":o=new M(this.schemaValidatorFactory,t,e,n,i,s,this.options);break;case"object":o=new j(this,this.schemaValidatorFactory,t,e,n,i,s,this.options);break;case"array":o=new k(this,this.schemaValidatorFactory,t,e,n,i,s,this.options);break;default:throw new TypeError("Undefined type "+t.type)}return o instanceof E&&this.initializeRoot(o),o},t.prototype.initializeRoot=function(t){t._bindVisibility()},t}(),L=function(){},W=function(n){function t(t){var e=n.call(this)||this;return e.options=t,e.ajv=new Ajv(Object.assign({},t.ajv,{errorDataPath:"property",allErrors:!0,jsonPointers:!0})),e.ajv.addFormat("data-url",/^data:([a-z]+\/[a-z0-9-+.]+)?;name=(.*);base64,(.*)$/),e.ajv.addFormat("color",/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/),e}return m(t,n),t.prototype.createValidatorFn=function(n,t){var i=this,r=[].concat(this.options.ingoreKeywords).concat(t.ingoreKeywords);return function(t){try{i.ajv.validate(n,t)}catch(t){}var e=i.ajv.errors;return i.options&&r&&e&&(e=e.filter(function(t){return-1===r.indexOf(t.keyword)})),e}},t.ctorParameters=function(){return[{type:b,decorators:[{type:r.Optional},{type:r.Inject,args:[b]}]}]},t}(L),$=function(){function t(){this.widgets={}}return t.prototype.setDefault=function(t){this.defaultWidget=t},t.prototype.register=function(t,e){this.widgets[t]=e},t.prototype.has=function(t){return this.widgets.hasOwnProperty(t)},t.prototype.getType=function(t){return this.has(t)?this.widgets[t]:this.defaultWidget},t}(),R=function(){function t(t,e){this.registry=t,this.resolver=e}return t.prototype.createWidget=function(t,e){this.registry.has(e)||console.warn('No widget for type "'+e+'"');var n=this.registry.getType(e),i=this.resolver.resolveComponentFactory(n);return t.createComponent(i)},t.decorators=[{type:r.Injectable}],t.ctorParameters=function(){return[{type:$},{type:r.ComponentFactoryResolver}]},t}();function q(t,e){return new A(t,e)}var H=function(){function t(t,e,n,i){this.formPropertyFactory=t,this.terminator=e,this.options=n,this.cd=i,this.rootProperty=null,this._valid=!0,this._inited=!1,this.layout="horizontal",this.button={},this._liveValidate=!0,this._firstVisual=!0,this.formChange=new r.EventEmitter,this.formSubmit=new r.EventEmitter,this.formReset=new r.EventEmitter,this.formError=new r.EventEmitter,this.liveValidate=n.liveValidate,this.firstVisual=n.firstVisual,this.autocomplete=n.autocomplete}return Object.defineProperty(t.prototype,"liveValidate",{get:function(){return this._liveValidate},set:function(t){this._liveValidate=e.coerceBooleanProperty(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstVisual",{get:function(){return this._firstVisual},set:function(t){this._firstVisual=e.coerceBooleanProperty(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mode",{get:function(){return this._mode},set:function(t){switch(t){case"search":this.layout="inline",this.firstVisual=!1,this.liveValidate=!1,this._btn&&(this._btn.submit="搜索");break;case"edit":this.layout="horizontal",this.firstVisual=!1,this.liveValidate=!0,this._btn&&(this._btn.submit="保存")}this._mode=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"valid",{get:function(){return this._valid},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._item},enumerable:!0,configurable:!0}),t.prototype.onSubmit=function(t){t.preventDefault(),t.stopPropagation(),this.liveValidate||this.validator(),this.valid&&this.formSubmit.emit(this.value)},t.prototype.coverProperty=function(){var l=this,u="horizontal"===this.layout,t=s.deepCopy(this.schema),p=t.definitions,c=function(r,t,o,s,a){Object.keys(r.properties).forEach(function(t){var e="$"+t,n=C(r.properties[t],p),i=Object.assign({widget:n.type},n.format&&v[n.format],"string"==typeof n.ui?{widget:n.ui}:null,!n.ui&&Array.isArray(n.enum)&&0<n.enum.length?{widget:"select"}:null,l._defUi,n.ui,o[e]);u?s.spanLabelFixed?i.spanLabelFixed||(i.spanLabelFixed=s.spanLabelFixed):(i.spanLabel||(i.spanLabel=void 0===s.spanLabel?5:s.spanLabel),i.spanControl||(i.spanControl=void 0===s.spanControl?19:s.spanControl),i.offsetControl||(i.offsetControl=void 0===s.offsetControl?null:s.offsetControl)):(i.spanLabel=null,i.spanControl=null,i.offsetControl=null),a[e]=i,delete n.ui,n.items&&(a[e].$items=a[e].$items||{},c(n.items,n.items,(o[e]||{}).$items||{},i,a[e].$items)),n.properties&&Object.keys(n.properties).length&&c(n,r,o[e]||{},i,a[e])})},o=function(i,r){Object.keys(i.properties).forEach(function(t){var e=i.properties[t],n="$"+t;_(e,r[n]),e.items&&o(e.items,r[n].$items),e.properties&&o(e,r[n])})};null==this.ui&&(this.ui={}),this._defUi=Object.assign({onlyVisual:this.options.onlyVisual,size:this.options.size,liveValidate:this.liveValidate,firstVisual:this.firstVisual},t.ui,this.ui["*"]),this._ui=Object.assign({},this._defUi),c(t,t,this.ui,this.ui,this._ui),_(t,this._ui),o(t,this._ui),this._schema=t,this._ui.debug&&w("cover schema & ui",this._ui,t)},t.prototype.coverButtonProperty=function(){this._btn=Object.assign({render:{}},this.options.button,this.button);var t=Object.keys(this._ui).find(function(t){return t.startsWith("$")});if("horizontal"===this.layout){var e=t?this._ui[t]:this._defUi;this._btn.render.grid||(this._btn.render.grid={offset:e.spanLabel,span:e.spanControl}),this._btn.render.spanLabelFixed||(this._btn.render.spanLabelFixed=e.spanLabelFixed),!this._btn.render.class&&"number"==typeof e.spanLabelFixed&&0<e.spanLabelFixed&&(this._btn.render.class="text-center")}else this._btn.render.grid={};this._mode&&(this.mode=this._mode),this._ui.debug&&w("button property",this._btn)},t.prototype.ngOnInit=function(){this._inited=!0,this.validator()},t.prototype.ngOnChanges=function(t){this.refreshSchema()},t.prototype._addTpl=function(t,e){var n=this.rootProperty.searchProperty(t);n?n.ui._render=e:console.warn("未找到路径 "+t)},t.prototype.validator=function(){this.rootProperty._runValidation();var t=this.rootProperty.errors;this._valid=!(t&&t.length),this.formError.emit(t),this.cd.detectChanges()},t.prototype.refreshSchema=function(t,e){var n=this;if(t&&(this.schema=t),e&&(this.ui=e),!this.schema||void 0===this.schema.properties)throw new Error("Invalid Schema");if(this.schema.ui&&"string"==typeof this.schema.ui)throw new Error("Don't support string with root ui property");this.schema.type="object",this._formData=g({},this.formData),this._inited&&this.terminator.destroy(),this.coverProperty(),this.coverButtonProperty(),this.rootProperty=this.formPropertyFactory.createProperty(this._schema,this._ui,this.formData),this.rootProperty.valueChanges.subscribe(function(t){n._item=Object.assign({},n.formData,t),n.formChange.emit(n._item)}),this.rootProperty.errorsChanges.subscribe(function(t){n._valid=!(t&&t.length),n.formError.emit(t),n.cd.detectChanges()}),this.reset()},t.prototype.reset=function(){var t=this;this.rootProperty.resetValue(this.formData,!1),Promise.resolve().then(function(){return t.cd.detectChanges()}),this.formReset.emit(this.value)},t.prototype.ngOnDestroy=function(){this.terminator.destroy()},t.decorators=[{type:r.Component,args:[{selector:"sf, [sf]",template:'\n  <ng-template #con><ng-content></ng-content></ng-template>\n  <form nz-form [nzLayout]="layout" (submit)="onSubmit($event)" [attr.autocomplete]="autocomplete">\n    <sf-item [formProperty]="rootProperty"></sf-item>\n    <ng-container *ngIf="button !== \'none\'; else con">\n      <nz-form-item [ngClass]="_btn.render.class" class="sf-btns" [fixed-label]="_btn.render.spanLabelFixed">\n        <nz-col class="ant-form-item-control-wrapper"\n          [nzSpan]="_btn.render.grid.span" [nzOffset]="_btn.render.grid.offset"\n          [nzXs]="_btn.render.grid.xs" [nzSm]="_btn.render.grid.sm" [nzMd]="_btn.render.grid.md"\n          [nzLg]="_btn.render.grid.lg" [nzXl]="_btn.render.grid.xl">\n          <div class="ant-form-item-control">\n            <ng-container *ngIf="button; else con">\n              <button type="submit" nz-button [nzType]="_btn.submit_type" [disabled]="liveValidate && !valid">{{_btn.submit}}</button>\n              <button *ngIf="_btn.reset" (click)="reset()" type="button" nz-button [nzType]="_btn.reset_type">{{_btn.reset}}</button>\n            </ng-container>\n          </div>\n        </nz-col>\n      </nz-form-item>\n    </ng-container>\n  </form>',providers:[R,{provide:A,useFactory:q,deps:[L,b]},S],host:{"[class.sf]":"true","[class.sf-search]":"mode === 'search'","[class.sf-edit]":"mode === 'edit'"},changeDetection:r.ChangeDetectionStrategy.OnPush}]}],t.ctorParameters=function(){return[{type:A},{type:S},{type:b},{type:r.ChangeDetectorRef}]},t.propDecorators={layout:[{type:r.Input}],schema:[{type:r.Input}],ui:[{type:r.Input}],formData:[{type:r.Input}],button:[{type:r.Input}],liveValidate:[{type:r.Input}],autocomplete:[{type:r.Input}],firstVisual:[{type:r.Input}],mode:[{type:r.Input}],formChange:[{type:r.Output}],formSubmit:[{type:r.Output}],formReset:[{type:r.Output}],formError:[{type:r.Output}]},t}(),N=0,B=function(){function t(t,e){this.widgetFactory=t,this.terminator=e,this.widget=null}return t.prototype.onWidgetInstanciated=function(t){this.widget=t;var e="_sf-"+N++,n=this.formProperty.ui;this.widget.formProperty=this.formProperty,this.widget.schema=this.formProperty.schema,this.widget.ui=n,this.widget.id=e,this.widget.firstVisual=n.firstVisual,this.formProperty.widget=t},t.prototype.ngOnInit=function(){var t=this;this.terminator.onDestroy.subscribe(function(){t.ngOnDestroy()})},t.prototype.ngOnChanges=function(t){this.ref=this.widgetFactory.createWidget(this.container,this.formProperty.ui.widget||this.formProperty.schema.type),this.onWidgetInstanciated(this.ref.instance)},t.prototype.ngOnDestroy=function(){this.formProperty.ui.__destroy=!0,this.ref.destroy()},t.decorators=[{type:r.Component,args:[{selector:"sf-item",template:"<ng-template #target></ng-template>"}]}],t.ctorParameters=function(){return[{type:R},{type:S}]},t.propDecorators={formProperty:[{type:r.Input}],container:[{type:r.ViewChild,args:["target",{read:r.ViewContainerRef}]}]},t}(),U=function(){function t(t,e){this.render=e,this._inited=!1,this.el=t.nativeElement}return t.prototype.init=function(){if(this._inited&&null!=this.num&&!(this.num<=0)){var t=this.el.querySelector(".ant-row")||this.el;this.render.addClass(t,"sf-fixed");var e=t.querySelector(".ant-form-item-label"),n=this.num+"px";if(e)this.render.setStyle(e,"width",n),this.render.setStyle(e,"flex","0 0 "+n);else{var i=t.querySelector(".ant-form-item-control-wrapper");this.render.setStyle(i,"margin-left",n)}}},t.prototype.ngAfterViewInit=function(){this._inited=!0,this.init()},t.prototype.ngOnChanges=function(t){this._inited&&this.init()},t.decorators=[{type:r.Directive,args:[{selector:"[fixed-label]"}]}],t.ctorParameters=function(){return[{type:r.ElementRef},{type:r.Renderer2}]},t.propDecorators={num:[{type:r.Input,args:["fixed-label"]}]},t}(),Y=function(){function t(){}return t.decorators=[{type:r.Component,args:[{selector:"sf-item-wrap",template:'\n  <nz-form-item>\n    <nz-col *ngIf="showTitle" [nzSpan]="ui.spanLabel" class="ant-form-item-label">\n      <label [attr.for]="id" [class.ant-form-item-required]="ui._required">\n        {{ schema.title }}\n        <span class="optional">\n          {{ ui.optional }}\n          <nz-tooltip *ngIf="ui.optionalHelp" [nzTitle]="ui.optionalHelp">\n            <i nz-tooltip class="anticon anticon-question-circle-o"></i>\n          </nz-tooltip>\n        </span>\n      </label>\n    </nz-col>\n    <nz-col class="ant-form-item-control-wrapper" [nzSpan]="ui.spanControl" [nzOffset]="ui.offsetControl">\n      <div class="ant-form-item-control" [class.has-error]="showError">\n        <ng-content></ng-content>\n        <nz-form-extra *ngIf="schema.description" [innerHTML]="schema.description"></nz-form-extra>\n        <nz-form-explain *ngIf="!ui.onlyVisual && showError">{{error}}</nz-form-explain>\n      </div>\n    </nz-col>\n  </nz-form-item>'}]}],t.propDecorators={id:[{type:r.Input}],schema:[{type:r.Input}],ui:[{type:r.Input}],showError:[{type:r.Input}],error:[{type:r.Input}],showTitle:[{type:r.Input}]},t}(),G=function(){function t(t,e){this.templateRef=t,this.table=e}return t.prototype.ngOnInit=function(){this.table._addTpl(this.path.startsWith("/")?this.path:"/"+this.path,this.templateRef)},t.decorators=[{type:r.Directive,args:[{selector:"[sf-template]"}]}],t.ctorParameters=function(){return[{type:r.TemplateRef},{type:H}]},t.propDecorators={path:[{type:r.Input,args:["sf-template"]}]},t}(),K=function(){function t(t,e){this.cd=t,this.sfComp=e,this.showError=!1,this.id="",this.firstVisual=!1}return Object.defineProperty(t.prototype,"cls",{get:function(){return this.ui.class||""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"disabled",{get:function(){return void 0!==this.schema.readOnly?this.schema.readOnly:null},enumerable:!0,configurable:!0}),t.prototype.ngAfterViewInit=function(){var e=this;this.formProperty.errorsChanges.pipe(l.filter(function(t){return null!=t})).subscribe(function(t){e.ui.debug&&w("errorsChanges",e.formProperty.path,t),e.firstVisual&&(e.showError=0<t.length,e.error=e.showError?t[0].message:"",!0!==e.ui.__destroy&&e.cd.detectChanges()),e.firstVisual=!0})},t.prototype.setValue=function(t){this.formProperty.setValue(t,!1),this.ui.debug&&w("valueChanges",this.formProperty.path,this.formProperty)},Object.defineProperty(t.prototype,"value",{get:function(){return this.formProperty.value},enumerable:!0,configurable:!0}),t.prototype.detectChanges=function(){this.cd.detectChanges(),this.formProperty.root.widget.cd.markForCheck()},t.ctorParameters=function(){return[{type:r.ChangeDetectorRef,decorators:[{type:r.Inject,args:[r.ChangeDetectorRef]}]},{type:H,decorators:[{type:r.Inject,args:[H]}]}]},t.propDecorators={cls:[{type:r.HostBinding,args:["class"]}]},t}(),X=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.reset=function(t){},e}(K),Z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.reset=function(t){},e.prototype.ngAfterViewInit=function(){var t=this;this.formProperty.errorsChanges.subscribe(function(){return t.cd.detectChanges()})},e}(K),J=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.reset=function(t){},e.prototype.ngAfterViewInit=function(){var t=this;this.formProperty.errorsChanges.subscribe(function(){return t.cd.detectChanges()})},e}(K),Q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.list=[],t}return m(t,e),t.prototype.ngOnInit=function(){this.grid=this.ui.grid;for(var t=[],e=0,n=this.formProperty.propertiesId;e<n.length;e++){var i=n[e],r=this.formProperty.properties[i],o={property:r,grid:r.ui.grid||this.grid||{},spanLabelFixed:r.ui.spanLabelFixed};t.push(o)}this.list=t},t.decorators=[{type:r.Component,args:[{selector:"sf-object",template:'\n  <ng-container *ngIf="grid; else noGrid">\n    <nz-row [nzGutter]="grid.gutter">\n      <ng-container *ngFor="let i of list">\n        <ng-container *ngIf="i.property.visible">\n          <nz-col\n            [nzSpan]="i.grid.span" [nzOffset]="i.grid.offset"\n            [nzXs]="i.grid.xs" [nzSm]="i.grid.sm" [nzMd]="i.grid.md"\n            [nzLg]="i.grid.lg" [nzXl]="i.grid.xl" [nzXXl]="i.grid.xxl">\n            <sf-item [formProperty]="i.property" [fixed-label]="i.spanLabelFixed"></sf-item>\n          </nz-col>\n        </ng-container>\n      </ng-container>\n    </nz-row>\n  </ng-container>\n  <ng-template #noGrid>\n    <ng-container *ngFor="let i of list">\n      <ng-container *ngIf="i.property.visible">\n        <sf-item [formProperty]="i.property" [fixed-label]="i.spanLabelFixed"></sf-item>\n      </ng-container>\n    </ng-container>\n  </ng-template>',preserveWhitespaces:!1}]}],t}(J),tt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.arraySpan=8,t}return m(t,e),Object.defineProperty(t.prototype,"addDisabled",{get:function(){return this.schema.maxItems&&this.formProperty.properties.length>=this.schema.maxItems},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){this.ui.grid&&this.ui.grid.arraySpan&&(this.arraySpan=this.ui.grid.arraySpan),this.addTitle=this.ui.addTitle||"添加",this.addType=this.ui.addType||"dashed",this.removeTitle=!1===this.ui.removable?null:this.ui.removeTitle||"移除"},t.prototype.addItem=function(){this.formProperty.add()},t.prototype.removeItem=function(t){this.formProperty.remove(t)},t.prototype.trackByIndex=function(t,e){return t},t.decorators=[{type:r.Component,args:[{selector:"sf-array",template:'\n  <nz-form-item>\n    <nz-col *ngIf="schema.title" [nzSpan]="ui.spanLabel" class="ant-form-item-label">\n      <label>\n        {{ schema.title }}\n        <span class="optional">\n          {{ ui.optional }}\n          <nz-tooltip *ngIf="ui.optionalHelp" [nzTitle]="ui.optionalHelp">\n            <i nz-tooltip class="anticon anticon-question-circle-o"></i>\n          </nz-tooltip>\n        </span>\n      </label>\n      <div class="add">\n        <button nz-button [nzType]="addType" [disabled]="addDisabled" (click)="addItem()" [innerHTML]="addTitle"></button>\n      </div>\n    </nz-col>\n    <nz-col class="ant-form-item-control-wrapper" [nzSpan]="ui.spanControl" [nzOffset]="ui.offsetControl">\n      <div class="ant-form-item-control" [class.has-error]="showError">\n\n        <nz-row class="sf-array-container">\n          <ng-container *ngFor="let i of formProperty.properties; let idx=index">\n            <nz-col [nzSpan]="arraySpan" *ngIf="i.visible">\n              <nz-card>\n                <sf-item [formProperty]="i"></sf-item>\n                <span *ngIf="removeTitle" class="remove" (click)="removeItem(idx)" [attr.title]="removeTitle">\n                  <i class="anticon anticon-delete"></i>\n                </span>\n              </nz-card>\n            </nz-col>\n          </ng-container>\n        </nz-row>\n\n        <nz-form-extra *ngIf="schema.description" [innerHTML]="schema.description"></nz-form-extra>\n        <nz-form-explain *ngIf="!ui.onlyVisual && showError">{{error}}</nz-form-explain>\n\n      </div>\n    </nz-col>\n  </nz-form-item>\n  '}]}],t}(Z),et=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.ngOnInit=function(){this.type=this.ui.addOnAfter||this.ui.addOnBefore||this.ui.addOnAfterIcon||this.ui.addOnBeforeIcon||this.ui.prefix||this.ui.prefixIcon||this.ui.suffix||this.ui.suffixIcon?"addon":""},e.decorators=[{type:r.Component,args:[{selector:"sf-string",template:'\n  <sf-item-wrap [id]="id" [schema]="schema" [ui]="ui" [showError]="showError" [error]="error" [showTitle]="schema.title">\n\n    <ng-template #ipt>\n      <input nz-input\n        [attr.id]="id"\n        [disabled]="disabled"\n        [nzSize]="ui.size"\n        [value]="value"\n        (input)="setValue($event.target?.value)"\n        [attr.maxLength]="schema.maxLength || null"\n        [attr.type]="ui.type || \'text\'"\n        [attr.placeholder]="ui.placeholder"\n        [attr.autocomplete]="ui.autocomplete"\n        [attr.autoFocus]="ui.autofocus">\n    </ng-template>\n\n    <ng-container *ngIf="type === \'addon\'; else ipt">\n      <nz-input-group\n        [nzAddOnBefore]="ui.addOnBefore" [nzAddOnAfter]="ui.addOnAfter"\n        [nzAddOnBeforeIcon]="ui.addOnBeforeIcon" [nzAddOnAfterIcon]="ui.addOnAfterIcon"\n        [nzPrefix]="ui.prefix" [nzPrefixIcon]="ui.prefixIcon"\n        [nzSuffix]="ui.suffix" [nzSuffixIcon]="ui.suffixIcon">\n        <ng-template [ngTemplateOutlet]="ipt"></ng-template>\n      </nz-input-group>\n    </ng-container>\n  </sf-item-wrap>\n  ',preserveWhitespaces:!1}]}],e}(X),nt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.formatter=function(t){return t},t.parser=function(t){return t},t}return m(t,e),t.prototype.ngOnInit=function(){void 0!==this.schema.minimum&&(this.min=this.schema.exclusiveMinimum?this.schema.minimum+1:this.schema.minimum),void 0!==this.schema.maximum&&(this.max=this.schema.exclusiveMaximum?this.schema.maximum-1:this.schema.maximum),this.step=this.schema.multipleOf||1,"integer"===this.schema.type&&(this.min=Math.trunc(this.min),this.max=Math.trunc(this.max),this.step=Math.trunc(this.step)),this.ui.formatter&&(this.formatter=this.ui.formatter),this.ui.parser&&(this.parser=this.ui.parser)},t.decorators=[{type:r.Component,args:[{selector:"sf-number",template:'\n  <sf-item-wrap [id]="id" [schema]="schema" [ui]="ui" [showError]="showError" [error]="error" [showTitle]="schema.title">\n    <nz-input-number\n      [ngModel]="value"\n      (ngModelChange)="setValue($event)"\n      [nzDisabled]="disabled"\n      [nzSize]="ui.size"\n      [nzMin]="min"\n      [nzMax]="max"\n      [nzStep]="step"\n      [nzFormatter]="formatter"\n      [nzParser]="parser"\n      [nzPrecision]="ui.precision">\n    </nz-input-number>\n  </sf-item-wrap>',preserveWhitespaces:!1}]}],t}(X),it={"date-time":"YYYY-MM-DDTHH:mm:ssZ"},rt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.ngOnInit=function(){this.type="date-time"===this.schema.format?"datetime-local":"date",this.format=!this.ui.format&&this.schema.format?it[this.schema.format]||"YYYY-MM-DD":this.ui.format},e.prototype.reset=function(t){this.formatDisplay(t)},e.prototype.formatData=function(t,e){return f(t,e,{locale:window.__locale__})},e.prototype.formatDisplay=function(t){},e.prototype._change=function(t){this.formatDisplay(t),this.setValue(this.formatData(t,this.format||"YYYY-MM-DD HH:mm:ss"))},e.decorators=[{type:r.Component,args:[{selector:"sf-date",template:'\n  <sf-item-wrap [id]="id" [schema]="schema" [ui]="ui" [showError]="showError" [error]="error" [showTitle]="schema.title">\n\n    <input nz-input\n      [attr.id]="id"\n      [disabled]="disabled"\n      [nzSize]="ui.size"\n      [value]="displayValue"\n      (input)="_change($event.target?.value)"\n      [attr.type]="type"\n      [attr.placeholder]="ui.placeholder"\n      autocomplete="off">\n\n  </sf-item-wrap>\n  ',preserveWhitespaces:!1}]}],e}(X),ot=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.displayValue=null,t}return m(t,e),t.prototype.ngOnInit=function(){var t=this.ui;this.format=t.format?t.format:"number"===this.schema.type?"x":"HH:mm:ss",this.i={displayFormat:t.displayFormat||"HH:mm:ss",allowEmpty:t.allowEmpty||!0,clearText:t.clearText||"清除",defaultOpenValue:t.defaultOpenValue||new Date,hideDisabledOptions:t.hideDisabledOptions||!1,hourStep:t.hourStep||1,minuteStep:t.nzMinuteStep||1,secondStep:t.secondStep||1}},t.prototype.reset=function(t){if(t instanceof Date)this.displayValue=t;else{var e=null!=t&&t.toString().length?new Date(t):null;null!=e&&"Invalid Date"===e.toString()&&(t.toString().split(":").length<=1&&(t+=":00"),e=new Date("1970-1-1 "+t)),this.displayValue=e}},t.prototype._change=function(t){null!=t?!0!==this.ui.utcEpoch?this.setValue(f(t,this.format)):this.setValue(Date.UTC(1970,0,1,t.getHours(),t.getMinutes(),t.getSeconds())):this.setValue(null)},t.decorators=[{type:r.Component,args:[{selector:"sf-time",template:'\n  <sf-item-wrap [id]="id" [schema]="schema" [ui]="ui" [showError]="showError" [error]="error" [showTitle]="schema.title">\n\n    <nz-time-picker\n      [(ngModel)]="displayValue"\n      (ngModelChange)="_change($event)"\n      [nzDisabled]="disabled"\n      [nzSize]="ui.size"\n      [nzFormat]="i.displayFormat"\n      [nzAllowEmpty]="i.allowEmpty"\n      [nzClearText]="i.clearText"\n      [nzDefaultOpenValue]="i.defaultOpenValue"\n      [nzDisabledHours]="ui.disabledHours"\n      [nzDisabledMinutes]="ui.disabledMinutes"\n      [nzDisabledSeconds]="ui.disabledSeconds"\n      [nzHideDisabledOptions]="i.hideDisabledOptions"\n      [nzHourStep]="i.hourStep"\n      [nzMinuteStep]="i.minuteStep"\n      [nzSecondStep]="i.secondStep"\n      [nzPopupClassName]="ui.popupClassName"\n      >\n    </nz-time-picker>\n\n  </sf-item-wrap>\n  ',preserveWhitespaces:!1}]}],t}(X),st=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=[],t}return m(t,e),t.prototype.reset=function(t){var e=this;this.styleType="default"===(this.ui.styleType||"default"),V(this.schema,this.ui,this.formProperty.formData).subscribe(function(t){return e.data=t})},t.decorators=[{type:r.Component,args:[{selector:"sf-radio",template:'\n  <sf-item-wrap [id]="id" [schema]="schema" [ui]="ui" [showError]="showError" [error]="error" [showTitle]="schema.title">\n\n    <nz-radio-group\n      [nzDisabled]="disabled"\n      [nzSize]="ui.size"\n      [nzName]="id"\n      [ngModel]="value"\n      (ngModelChange)="setValue($event)">\n      <ng-container *ngIf="styleType">\n        <label *ngFor="let option of data"\n          nz-radio\n          [nzValue]="option.value"\n          [nzDisabled]="option.disabled">\n          <span [innerHTML]="option.label"></span>\n        </label>\n      </ng-container>\n      <ng-container *ngIf="!styleType">\n        <label *ngFor="let option of data"\n          nz-radio-button\n          [nzValue]="option.value"\n          [nzDisabled]="option.disabled">\n          <span [innerHTML]="option.label"></span>\n        </label>\n      </ng-container>\n    </nz-radio-group>\n\n  </sf-item-wrap>\n  ',preserveWhitespaces:!1}]}],t}(X),at=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=[],t.allChecked=!1,t.indeterminate=!1,t}return m(t,e),t.prototype.reset=function(t){var e=this;V(this.schema,this.ui,this.formProperty.formData).subscribe(function(t){e.data=t,e.label=e.ui.spanLabel,e.control=e.ui.spanControl,0===t.length&&(e.label=null,e.offset=e.ui.spanLabel),e.grid_span=e.ui.grid&&0<e.ui.grid.span?e.ui.grid.span:0,e.updateAllChecked()})},t.prototype._setValue=function(t){this.setValue(t),this.detectChanges(),this.notifyChange(t)},t.prototype.notifySet=function(){var t=this.data.filter(function(t){return t.checked});this.updateAllChecked().setValue(t.map(function(t){return t.value})),this.notifyChange(t)},t.prototype.groupInGridChange=function(e){this.data.forEach(function(t){return t.checked=-1!==e.indexOf(t.value)}),this.notifySet()},t.prototype.onAllChecked=function(t){var e=this;t.stopPropagation(),this.data.forEach(function(t){return t.checked=e.allChecked}),this.notifySet()},t.prototype.updateAllChecked=function(){return this.data.every(function(t){return!1===t.checked})?(this.allChecked=!1,this.indeterminate=!1):this.data.every(function(t){return!0===t.checked})?(this.allChecked=!0,this.indeterminate=!1):this.indeterminate=!0,this.detectChanges(),this},t.prototype.notifyChange=function(t){this.ui.change&&this.ui.change(t)},t.decorators=[{type:r.Component,args:[{selector:"sf-checkbox",template:'\n  <ng-template #all>\n    <label *ngIf="ui.checkAll" nz-checkbox class="mr-sm"\n      [(ngModel)]="allChecked"\n      [nzIndeterminate]="indeterminate"\n      (click)="onAllChecked($event)">\n      {{ ui.checkAllText || \'全选\' }}\n    </label>\n  </ng-template>\n  <nz-form-item>\n    <nz-form-label *ngIf="data.length > 0" [nzSpan]="label" [nzRequired]="ui._required">\n      {{ schema.title }}\n      <span class="optional">\n        {{ ui.optional }}\n        <nz-tooltip *ngIf="ui.optionalHelp" [nzTitle]="ui.optionalHelp">\n          <i nz-tooltip class="anticon anticon-question-circle-o"></i>\n        </nz-tooltip>\n      </span>\n    </nz-form-label>\n    <nz-col class="ant-form-item-control-wrapper" [nzSpan]="control" [nzOffset]="offset">\n      <div class="ant-form-item-control" [class.has-error]="showError">\n\n          <ng-container *ngIf="data.length === 0">\n            <label nz-checkbox\n              [nzDisabled]="disabled"\n              [ngModel]="value"\n              (ngModelChange)="_setValue($event)">\n              <span [innerHTML]="schema.title"></span>\n              <span class="optional">\n                {{ ui.optional }}\n                <nz-tooltip *ngIf="ui.optionalHelp" [nzTitle]="ui.optionalHelp">\n                  <i nz-tooltip class="anticon anticon-question-circle-o"></i>\n                </nz-tooltip>\n              </span>\n            </label>\n          </ng-container>\n          <ng-container *ngIf="data.length > 0">\n            <ng-container *ngIf="grid_span === 0">\n              <ng-template [ngTemplateOutlet]="all"></ng-template>\n              <nz-checkbox-group [ngModel]="data" (ngModelChange)="notifySet()"></nz-checkbox-group>\n            </ng-container>\n            <ng-container *ngIf="grid_span !== 0">\n              <nz-checkbox-wrapper class="checkbox-grid-list" (nzOnChange)="groupInGridChange($event)">\n                <nz-row>\n                  <nz-col [nzSpan]="grid_span" *ngIf="ui.checkAll">\n                    <ng-template [ngTemplateOutlet]="all"></ng-template>\n                  </nz-col>\n                  <nz-col [nzSpan]="grid_span" *ngFor="let i of data">\n                    <label nz-checkbox [nzValue]="i.value" [ngModel]="i.checked" [nzDisabled]="i.disabled">{{i.label}}</label>\n                  </nz-col>\n                </nz-row>\n              </nz-checkbox-wrapper>\n            </ng-container>\n          </ng-container>\n\n          <nz-form-extra *ngIf="schema.description" [innerHTML]="schema.description"></nz-form-extra>\n          <nz-form-explain *ngIf="!ui.onlyVisual && showError">{{error}}</nz-form-explain>\n      </div>\n    </nz-col>\n  </nz-form-item>\n  ',preserveWhitespaces:!1}]}],t}(X),lt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.decorators=[{type:r.Component,args:[{selector:"sf-boolean",template:'\n  <sf-item-wrap [id]="id" [schema]="schema" [ui]="ui" [showError]="showError" [error]="error" [showTitle]="schema.title">\n    <nz-switch\n      [ngModel]="value"\n      (ngModelChange)="setValue($event)"\n      [nzDisabled]="disabled"\n      [nzSize]="ui.size"\n      [nzCheckedChildren]="ui.checkedChildren"\n      [nzUnCheckedChildren]="ui.unCheckedChildren">\n    </nz-switch>\n  </sf-item-wrap>',preserveWhitespaces:!1}]}],e}(X),ut=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.decorators=[{type:r.Component,args:[{selector:"sf-textarea",template:'\n  <sf-item-wrap [id]="id" [schema]="schema" [ui]="ui" [showError]="showError" [error]="error" [showTitle]="schema.title">\n\n    <textarea nz-input\n      [attr.id]="id"\n      [disabled]="disabled"\n      [nzSize]="ui.size"\n      [value]="value"\n      (input)="setValue($event.target?.value)"\n      [attr.maxLength]="schema.maxLength || null"\n      [attr.placeholder]="ui.placeholder"\n      [nzAutosize]="ui.autosize">\n    </textarea>\n\n  </sf-item-wrap>',preserveWhitespaces:!1}]}],e}(X),pt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasGroup=!1,t}return m(t,e),t.prototype.ngOnInit=function(){this.i={allowClear:this.ui.allowClear,autoFocus:this.ui.autoFocus||!1,dropdownClassName:this.ui.dropdownClassName||null,dropdownMatchSelectWidth:this.ui.dropdownMatchSelectWidth||!0,serverSearch:this.ui.serverSearch||!1,maxMultipleCount:this.ui.maxMultipleCount||1/0,mode:this.ui.mode||"default",notFoundContent:this.ui.notFoundContent||"无法找到",showSearch:this.ui.showSearch||!0}},t.prototype.reset=function(t){var e=this;V(this.schema,this.ui,this.formProperty.formData).subscribe(function(t){e.data=t,e.hasGroup=0<t.filter(function(t){return!0===t.group}).length,e.detectChanges()})},t.prototype.openChange=function(t){this.ui.openChange&&this.ui.openChange(t)},t.prototype.searchChange=function(t){var e=this;this.ui.onSearch?this.ui.onSearch(t).then(function(t){e.data=t,e.detectChanges()}):this.detectChanges()},t.prototype.scrollToBottom=function(t){this.ui.scrollToBottom&&this.ui.scrollToBottom(t)},t.decorators=[{type:r.Component,args:[{selector:"sf-select",template:'\n  <sf-item-wrap [id]="id" [schema]="schema" [ui]="ui" [showError]="showError" [error]="error" [showTitle]="schema.title">\n\n    <nz-select\n      [nzDisabled]="disabled"\n      [nzSize]="ui.size"\n      [ngModel]="value"\n      (ngModelChange)="setValue($event)"\n      [nzPlaceHolder]="ui.placeholder"\n      [nzAllowClear]="i.allowClear"\n      [nzAutoFocus]="i.autoFocus"\n      [nzDropdownClassName]="i.dropdownClassName"\n      [nzDropdownMatchSelectWidth]="i.dropdownMatchSelectWidth"\n      [nzServerSearch]="i.serverSearch"\n      [nzMaxMultipleCount]="i.maxMultipleCount"\n      [nzMode]="i.mode"\n      [nzNotFoundContent]="i.notFoundContent"\n      [nzShowSearch]="i.showSearch"\n      (nzOpenChange)="openChange($event)"\n      (nzOnSearch)="searchChange($event)"\n      (nzScrollToBottom)="scrollToBottom($event)">\n      <ng-container *ngIf="!hasGroup">\n        <nz-option\n          *ngFor="let o of data"\n          [nzLabel]="o.label"\n          [nzValue]="o.value"\n          [nzDisabled]="o.disabled">\n        </nz-option>\n      </ng-container>\n      <ng-container *ngIf="hasGroup">\n        <nz-option-group *ngFor="let i of data" [nzLabel]="i.label">\n          <nz-option\n            *ngFor="let o of i.children"\n            [nzLabel]="o.label"\n            [nzValue]="o.value"\n            [nzDisabled]="o.disabled">\n          </nz-option>\n        </nz-option-group>\n      </ng-container>\n    </nz-select>\n\n  </sf-item-wrap>\n  ',preserveWhitespaces:!1}]}],t}(X),ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.reset=function(t){var e=this;V(this.schema,this.ui,this.formProperty.formData).subscribe(function(t){e.data=t,e.detectChanges()})},e.prototype.onChange=function(t){t.checked=!t.checked,this.updateValue(),this.ui.checkedChange&&this.ui.checkedChange(t.checked)},e.prototype._afterClose=function(){this.ui.afterClose&&this.ui.afterClose()},e.prototype._close=function(t){this.ui.onClose&&this.ui.onClose(t)},e.prototype.updateValue=function(){this.formProperty.setValue(this.data.filter(function(t){return t.checked}).map(function(t){return t.value}),!1)},e.decorators=[{type:r.Component,args:[{selector:"sf-tag",template:'\n  <sf-item-wrap [id]="id" [schema]="schema" [ui]="ui" [showError]="showError" [error]="error" [showTitle]="schema.title">\n\n    <nz-tag\n      *ngFor="let i of data"\n      nzMode="checkable"\n      [nzChecked]="i.checked"\n      (nzAfterClose)="_afterClose()"\n      (nzOnClose)="_close($event)"\n      (nzCheckedChange)="onChange(i)">\n      {{i.label}}\n    </nz-tag>\n\n  </sf-item-wrap>\n  ',preserveWhitespaces:!1}]}],e}(X),ht=function(i){function t(t,e){var n=i.call(this,t)||this;return n.modalSrv=e,n.fileList=[],n.btnType="",n.handlePreview=function(t){n.modalSrv.create({nzContent:'<img src="'+(t.url||t.thumbUrl)+'" class="img-fluid" />',nzFooter:null}).afterClose.subscribe(function(){return n.detectChanges()})},n}return m(t,i),t.prototype.ngOnInit=function(){this.i={type:this.ui.type||"select",text:this.ui.text||"点击上传",action:this.ui.action||"",accept:this.ui.accept||"",limit:null==this.ui.limit?0:+this.ui.limit,size:null==this.ui.size?0:+this.ui.size,fileType:this.ui.fileType||"",listType:this.ui.listType||"text",multiple:this.ui.multiple||!1,name:this.ui.name||"file",showUploadList:this.ui.showUploadList||!0,withCredentials:this.ui.withCredentials||!1,resReName:(this.ui.resReName||"").split(".")},"picture-card"===this.i.listType&&(this.btnType="plus"),"drag"===this.i.type&&(this.i.listType=null,this.btnType="drag",this.i.text=this.ui.text||"单击或拖动文件到该区域上传",this.i.hint=this.ui.hint||"支持单个或批量，严禁上传公司数据或其他安全文件")},t.prototype.change=function(t){this.ui.change&&this.ui.change(t),"success"===t.type&&this.notify(t.fileList)},t.prototype.reset=function(t){var e=this;V(this.schema,this.ui,this.formProperty.formData).subscribe(function(t){e.fileList=t,e.notify(e.fileList),e.detectChanges()})},t.prototype.notify=function(t){var e=this,n=t.map(function(t){return s.deepGet(t.response,e.i.resReName,t.response)});this.formProperty.setValue(!0===this.i.multiple?n:n.pop(),!1)},t.decorators=[{type:r.Component,args:[{selector:"sf-upload",template:'\n  <sf-item-wrap [id]="id" [schema]="schema" [ui]="ui" [showError]="showError" [error]="error" [showTitle]="schema.title">\n\n    <nz-upload\n      [nzType]="i.type"\n      [nzFileList]="fileList"\n      [nzDisabled]="disabled"\n      [nzAction]="i.action"\n      [nzAccept]="i.accept"\n      [nzLimit]="i.limit"\n      [nzSize]="i.size"\n      [nzFileType]="i.fileType"\n      [nzHeaders]="ui.headers"\n      [nzData]="ui.data"\n      [nzListType]="i.listType"\n      [nzMultiple]="i.multiple"\n      [nzName]="i.argName"\n      [nzShowUploadList]="i.showUploadList"\n      [nzWithCredentials]="i.withCredentials"\n      [nzRemove]="ui.remove"\n      [nzPreview]="handlePreview"\n      (nzChange)="change($event)">\n      <ng-container [ngSwitch]="btnType">\n        <ng-container *ngSwitchCase="\'plus\'">\n          <i class="anticon anticon-plus"></i>\n          <div class="ant-upload-text" [innerHTML]="i.text"></div>\n        </ng-container>\n        <ng-container *ngSwitchCase="\'drag\'">\n          <p class="ant-upload-drag-icon"><i class="anticon anticon-inbox"></i></p>\n          <p class="ant-upload-text" [innerHTML]="i.text"></p>\n          <p class="ant-upload-hint" [innerHTML]="i.hint"></p>\n        </ng-container>\n        <ng-container *ngSwitchDefault>\n          <button type="button" nz-button>\n            <i class="anticon anticon-upload"></i><span [innerHTML]="i.text"></span>\n          </button>\n        </ng-container>\n      </ng-container>\n    </nz-upload>\n\n  </sf-item-wrap>\n  ',preserveWhitespaces:!1}]}],t.ctorParameters=function(){return[{type:r.ChangeDetectorRef},{type:h.NzModalService}]},t}(X),ft=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.list=[],e._data=[],e._canMove=function(t){return e.ui.canMove?e.ui.canMove(t):o.of(t.list)},e}return m(e,t),e.prototype.ngOnInit=function(){this.i={titles:this.ui.titles||["",""],operations:this.ui.operations||["",""],itemUnit:this.ui.itemUnit||"项",itemsUnit:this.ui.itemsUnit||"项"}},e.prototype.reset=function(t){var n=this;V(this.schema,this.ui,null).subscribe(function(t){var e=n.formProperty.formData;Array.isArray(e)||(e=[e]),t.forEach(function(t){~e.indexOf(t.value)&&(t.direction="right")}),n.list=t,n._data=t.filter(function(t){return"right"===t.direction}),n.notify(),n.detectChanges()})},e.prototype.notify=function(){this.formProperty.setValue(this._data.map(function(t){return t.value}),!1)},e.prototype._change=function(e){var t;"right"===e.to?this._data=(t=this._data).concat.apply(t,e.list):this._data=this._data.filter(function(t){return-1===e.list.indexOf(t)}),this.ui.change&&this.ui.change(e),this.notify()},e.prototype._searchChange=function(t){this.ui.searchChange&&this.ui.searchChange(t)},e.prototype._selectChange=function(t){this.ui.selectChange&&this.ui.selectChange(t),this.cd.detectChanges()},e.decorators=[{type:r.Component,args:[{selector:"sf-transfer",template:'\n  <sf-item-wrap [id]="id" [schema]="schema" [ui]="ui" [showError]="showError" [error]="error" [showTitle]="schema.title">\n\n    <nz-transfer\n      [nzDataSource]="list"\n      [nzTitles]="i.titles"\n      [nzOperations]="i.operations"\n      [nzListStyle]="ui.listStyle"\n      [nzItemUnit]="i.itemUnit"\n      [nzItemsUnit]="i.itemsUnit"\n      [nzShowSearch]="ui.showSearch"\n      [nzFilterOption]="ui.filterOption"\n      [nzSearchPlaceholder]="ui.searchPlaceholder"\n      [nzNotFoundContent]="ui.notFoundContent"\n      [nzCanMove]="_canMove"\n      (nzChange)="_change($event)"\n      (nzSearchChange)="_searchChange($event)"\n      (nzSelectChange)="_selectChange($event)">\n    </nz-transfer>\n\n  </sf-item-wrap>\n  ',preserveWhitespaces:!1}]}],e}(X),dt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._formatter=function(t){return e.ui.formatter?e.ui.formatter(t):t},e}return m(e,t),e.prototype.ngOnInit=function(){this.min=this.schema.minimum||0,this.max=this.schema.maximum||100,this.step=this.schema.multipleOf||1,this.marks=this.ui.marks||null;var t=this.ui.included;this.included=void 0===t||t},e.prototype._afterChange=function(t){this.ui.afterChange&&this.ui.afterChange(t)},e.decorators=[{type:r.Component,args:[{selector:"sf-slider",template:'\n  <sf-item-wrap [id]="id" [schema]="schema" [ui]="ui" [showError]="showError" [error]="error" [showTitle]="schema.title">\n\n    <nz-slider\n      [ngModel]="value"\n      (ngModelChange)="setValue($event)"\n      [nzDisabled]="disabled"\n      [nzRange]="ui.range"\n      [nzMin]="min"\n      [nzMax]="max"\n      [nzStep]="step"\n      [nzMarks]="marks"\n      [nzDots]="ui.dots"\n      [nzIncluded]="included"\n      [nzVertical]="ui.vertical"\n      [nzTipFormatter]="_formatter"\n      (nzOnAfterChange)="_afterChange($event)">\n    </nz-slider>\n\n  </sf-item-wrap>\n  ',preserveWhitespaces:!1}]}],e}(X),mt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.decorators=[{type:r.Component,args:[{selector:"sf-custom",template:'\n  <sf-item-wrap [id]="id" [schema]="schema" [ui]="ui" [showError]="showError" [error]="error" [showTitle]="schema.title">\n\n    <ng-template\n      [ngTemplateOutlet]="$any(ui)._render"\n      [ngTemplateOutletContext]="{$implicit: this, schema: schema, ui: ui }"></ng-template>\n\n  </sf-item-wrap>\n  ',preserveWhitespaces:!1}]}],e}(X),gt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasText=!1,t}return m(t,e),t.prototype.ngOnInit=function(){this.count=this.schema.maximum||5,this.allowHalf=.5===(this.schema.multipleOf||.5),this.allowClear=this.ui.allowClear||!0,this.autoFocus=this.ui.autoFocus||!1,this.hasText=!!this.ui.text},t.prototype.genText=function(){return this.hasText?this.ui.text.replace("{{value}}",this.formProperty.value):""},t.decorators=[{type:r.Component,args:[{selector:"sf-rate",template:'\n  <sf-item-wrap [id]="id" [schema]="schema" [ui]="ui" [showError]="showError" [error]="error" [showTitle]="schema.title">\n\n    <nz-rate\n      [nzDisabled]="disabled"\n      [ngModel]="value"\n      (ngModelChange)="setValue($event)"\n      [nzAllowClear]="allowClear"\n      [nzAllowHalf]="allowHalf"\n      [nzAutoFocus]="autoFocus"\n      [nzCount]="count"></nz-rate>\n    <span *ngIf="hasText && formProperty.value" class="ant-rate-text">{{ genText() }}</span>\n\n  </sf-item-wrap>\n  ',preserveWhitespaces:!1}]}],t}(X),yt=["qq.com","163.com","gmail.com","126.com","aliyun.com"],bt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fixData=[],t.isAsync=!1,t}return m(t,e),t.prototype.ngOnInit=function(){var e=this;this.i={backfill:this.ui.backfill||!1,defaultActiveFirstOption:this.ui.defaultActiveFirstOption||!0,width:this.ui.width||void 0},this.filterOption=this.ui.filterOption||!0,"boolean"==typeof this.filterOption&&(this.filterOption=!0===this.filterOption?function(t,e){return-1<e.label.toLowerCase().indexOf(t.toLowerCase())}:function(){return!0}),this.isAsync=!!this.ui.asyncData;var t=+(this.ui.debounceTime||0),n=Math.max(0,this.isAsync?Math.max(50,t):t);this.list=this.formProperty.valueChanges.pipe(l.debounceTime(n),l.startWith(""),l.flatMap(function(t){return e.isAsync?e.ui.asyncData(t):e.filterData(t)}),l.map(function(t){return O(t,null)}))},t.prototype.reset=function(t){if(!this.isAsync)switch(this.ui.type){case"email":this.fixData=P(yt,null);break;default:this.fixData=P(this.schema.enum,this.formProperty.formData)}},t.prototype.filterData=function(e){var n=this;switch(this.ui.type){case"email":return this.addEmailSuffix(e);default:return o.of(this.fixData.filter(function(t){return n.filterOption(e,t)}))}},t.prototype.addEmailSuffix=function(e){return o.of(!e||~e.indexOf("@")?[]:this.fixData.map(function(t){return e+"@"+t.label}))},t.decorators=[{type:r.Component,args:[{selector:"sf-autocomplete",template:'\n    <sf-item-wrap [id]="id" [schema]="schema" [ui]="ui" [showError]="showError" [error]="error" [showTitle]="schema.title">\n      <input nz-input [nzAutocomplete]="auto"\n        [attr.id]="id"\n        [disabled]="disabled"\n        [nzSize]="ui.size"\n        [value]="value"\n        (input)="setValue($event.target?.value)"\n        [attr.maxLength]="schema.maxLength || null"\n        [attr.placeholder]="ui.placeholder"\n        autocomplete="off">\n      <nz-autocomplete #auto\n        [nzBackfill]="i.backfill"\n        [nzDefaultActiveFirstOption]="i.defaultActiveFirstOption"\n        [nzWidth]="i.width"\n        (selectionChange)="setValue($event?.nzValue)">\n        <nz-auto-option *ngFor="let i of list | async" [nzValue]="i.label">{{i.label}}</nz-auto-option>\n      </nz-autocomplete>\n    </sf-item-wrap>\n    ',preserveWhitespaces:!1}]}],t}(X),vt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=[],t}return m(t,e),t.prototype.ngOnInit=function(){var n=this;this.clearText=this.ui.clearText||"清除",this.showArrow=this.ui.showArrow||!0,this.showInput=this.ui.showInput||!0,this.triggerAction=this.ui.triggerAction||["click"],this.ui.loadData&&(this.loadData=function(t,e){return n.ui.loadData(t,e,n)})},t.prototype.reset=function(t){var e=this;V(this.schema,this.ui,this.formProperty.formData).subscribe(function(t){e.data=t,e.detectChanges()})},t.prototype._visibleChange=function(t){this.ui.visibleChange&&this.ui.visibleChange(t)},t.prototype._change=function(t){this.setValue(t),this.ui.change&&this.ui.change(t)},t.prototype._selectionChange=function(t){this.ui.selectionChange&&this.ui.selectionChange(t)},t.prototype._select=function(t){this.ui.select&&this.ui.select(t)},t.prototype._clear=function(t){this.ui.clear&&this.ui.clear(t)},t.decorators=[{type:r.Component,args:[{selector:"sf-cascader",template:'\n  <sf-item-wrap [id]="id" [schema]="schema" [ui]="ui" [showError]="showError" [error]="error" [showTitle]="schema.title">\n\n    <nz-cascader\n      [nzDisabled]="disabled"\n      [nzSize]="ui.size"\n      [ngModel]="value"\n      (ngModelChange)="_change($event)"\n      [nzOptions]="data"\n      [nzAllowClear]="ui.allowClear"\n      [nzAutoFocus]="ui.autoFocus"\n      [nzChangeOn]="ui.changeOn"\n      [nzChangeOnSelect]="ui.changeOnSelect"\n      [nzColumnClassName]="ui.columnClassName"\n      [nzExpandTrigger]="ui.expandTrigger"\n      [nzMenuClassName]="ui.menuClassName"\n      [nzMenuStyle]="ui.menuStyle"\n      [nzLabelProperty]="ui.labelProperty"\n      [nzValueProperty]="ui.valueProperty"\n      [nzLoadData]="loadData"\n      [nzPlaceHolder]="ui.placeholder"\n      [nzShowArrow]="showArrow"\n      [nzShowInput]="showInput"\n      (nzClear)="_clear($event)"\n      (nzVisibleChange)="_visibleChange($event)"\n      (nzSelect)="_select($event)"\n      (nzSelectionChange)="_selectionChange($event)">\n    </nz-cascader>\n\n  </sf-item-wrap>\n  ',preserveWhitespaces:!1}]}],t}(X),zt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=[],t.loading=!1,t}return m(t,e),t.prototype.ngOnInit=function(){var r=this;this.i={valueWith:this.ui.valueWith||function(t){return t.label},notFoundContent:this.ui.notFoundContent||"无匹配结果，轻敲空格完成输入",placement:this.ui.placement||"bottom",prefix:this.ui.prefix||"@"};var o=void 0!==this.schema.minimum?this.schema.minimum:-1,s=void 0!==this.schema.maximum?this.schema.maximum:-1;this.ui.validator||-1===o&&-1===s||(this.ui.validator=function(t,e,n){var i=r.mentionChild.getMentions().length;return-1!==o&&i<o?[{keyword:"mention",message:"最少提及 "+o+" 次"}]:-1!==s&&s<i?[{keyword:"mention",message:"最多提及 "+s+" 次"}]:null})},t.prototype.reset=function(t){var e=this;V(this.schema,this.ui,null).subscribe(function(t){e.data=t,e.detectChanges()})},t.prototype._select=function(t){this.ui.select&&this.ui.select(t)},t.prototype._search=function(t){var e=this;"function"==typeof this.ui.loadData&&(this.loading=!0,this.ui.loadData(t).pipe(l.tap(function(){return e.loading=!1}),l.map(function(t){return O(t,null)})).subscribe(function(t){e.data=t,e.cd.detectChanges()}))},t.decorators=[{type:r.Component,args:[{selector:"sf-mention",template:'\n    <sf-item-wrap [id]="id" [schema]="schema" [ui]="ui" [showError]="showError" [error]="error" [showTitle]="schema.title">\n\n      <nz-mention #mentions\n        [nzSuggestions]="data"\n        [nzValueWith]="i.valueWith"\n        [nzLoading]="loading"\n        [nzNotFoundContent]="i.notFoundContent"\n        [nzPlacement]="i.placement"\n        [nzPrefix]="i.prefix"\n        (nzOnSelect)="_select($event)"\n        (nzOnSearchChange)="_search($event)">\n\n        <ng-container *ngIf="ui.inputStyle !== \'textarea\'">\n          <input nzMentionTrigger nz-input\n            [attr.id]="id"\n            [disabled]="disabled"\n            [nzSize]="ui.size"\n            [ngModel]="value"\n            (ngModelChange)="setValue($event)"\n            [attr.maxLength]="schema.maxLength || null"\n            [attr.placeholder]="ui.placeholder"\n            autocomplete="off">\n        </ng-container>\n\n        <ng-container *ngIf="ui.inputStyle === \'textarea\'">\n          <textarea nzMentionTrigger nz-input\n            [attr.id]="id"\n            [disabled]="disabled"\n            [nzSize]="ui.size"\n            [ngModel]="value"\n            (ngModelChange)="setValue($event)"\n            [attr.maxLength]="schema.maxLength || null"\n            [attr.placeholder]="ui.placeholder"\n            [nzAutosize]="ui.autosize">\n          </textarea>\n        </ng-container>\n\n      </nz-mention>\n\n    </sf-item-wrap>\n    ',preserveWhitespaces:!1}]}],t.propDecorators={mentionChild:[{type:r.ViewChild,args:["mentions"]}]},t}(X),wt=function(e){function t(){var t=e.call(this)||this;return t.register("object",Q),t.register("array",tt),t.register("string",et),t.register("number",nt),t.register("integer",nt),t.register("date",rt),t.register("time",ot),t.register("radio",st),t.register("checkbox",at),t.register("boolean",lt),t.register("textarea",ut),t.register("select",pt),t.register("tag",ct),t.register("upload",ht),t.register("transfer",ft),t.register("slider",dt),t.register("rate",gt),t.register("autocomplete",bt),t.register("cascader",vt),t.register("mention",zt),t.register("custom",mt),t.setDefault(et),t}return m(t,e),t}($),Ct=[H,B,Y,G,U],_t=[Q,tt,et,nt,rt,ot,st,at,lt,ut,pt,ct,ht,ft,dt,gt,bt,vt,zt,mt],xt=function(){function t(){}return t.forRoot=function(){return{ngModule:t,providers:[b,{provide:L,useClass:W},{provide:$,useClass:wt}]}},t.decorators=[{type:r.NgModule,args:[{imports:[i.CommonModule,c.FormsModule,s.DelonUtilModule,h.NgZorroAntdModule],declarations:Ct.concat(_t),entryComponents:_t.slice(),exports:Ct.slice()}]}],t}();t.DelonFormConfig=b,t.useFactory=q,t.SFComponent=H,t.SFItemComponent=B,t.SFFixedDirective=U,t.DelonFormModule=xt,t.ERRORSDEFAULT=y,t.FormProperty=I,t.PropertyGroup=E,t.FormPropertyFactory=A,t.AtomicProperty=D,t.ObjectProperty=j,t.ArrayProperty=k,t.StringProperty=F,t.NumberProperty=T,t.BooleanProperty=M,t.Widget=K,t.ControlWidget=X,t.ArrayLayoutWidget=Z,t.ObjectLayoutWidget=J,t.ObjectWidget=Q,t.ArrayWidget=tt,t.StringWidget=et,t.NumberWidget=nt,t.DateWidget=rt,t.TimeWidget=ot,t.RadioWidget=st,t.CheckboxWidget=at,t.BooleanWidget=lt,t.TextareaWidget=ut,t.SelectWidget=pt,t.TagWidget=ct,t.UploadWidget=ht,t.TransferWidget=ft,t.SliderWidget=dt,t.RateWidget=gt,t.AutoCompleteWidget=bt,t.CascaderWidget=vt,t.MentionWidget=zt,t.CustomWidget=mt,t.NzWidgetRegistry=wt,t.WidgetRegistry=$,t.WidgetFactory=R,t.SchemaValidatorFactory=L,t.AjvSchemaValidatorFactory=W,t.ɵb=Y,t.ɵa=S,t.ɵc=G,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=form.umd.min.js.map
