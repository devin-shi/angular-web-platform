{"version":3,"file":"water-wave.component.js","sourceRoot":"","sources":["../../../../../../packages/abc/charts/water-wave/water-wave.component.ts"],"names":[],"mappings":"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","sourcesContent":["import {\r\n  Component,\r\n  Input,\r\n  HostBinding,\r\n  ViewChild,\r\n  ElementRef,\r\n  OnDestroy,\r\n  OnChanges,\r\n  SimpleChanges,\r\n  NgZone,\r\n  TemplateRef,\r\n  OnInit,\r\n  HostListener,\r\n  ViewEncapsulation,\r\n  Renderer2,\r\n  SimpleChange,\r\n  ChangeDetectionStrategy,\r\n  ChangeDetectorRef,\r\n} from '@angular/core';\r\nimport { Subscription } from 'rxjs/Subscription';\r\nimport { Observable } from 'rxjs/Observable';\r\nimport { debounceTime } from 'rxjs/operators';\r\nimport { FromEventObservable } from 'rxjs/observable/FromEventObservable';\r\nimport { coerceNumberProperty } from '@angular/cdk/coercion';\r\n\r\n@Component({\r\n  selector: 'g2-water-wave',\r\n  template: `\r\n  <div [ngStyle]=\"{'height.px': height, 'width.px': height, 'overflow': 'hidden'}\">\r\n    <canvas #container class=\"canvas-wrap\" width=\"{{height*2}}\" height=\"{{height*2}}\"></canvas>\r\n  </div>\r\n  <div class=\"text\" [ngStyle]=\"{'width.px': height}\">\r\n    <ng-container *ngIf=\"_title; else _titleTpl\"><span>{{_title}}</span></ng-container>\r\n    <h4>{{percent}}%</h4>\r\n  </div>`,\r\n  host: { '[class.ad-water-wave]': 'true' },\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n  preserveWhitespaces: false,\r\n})\r\nexport class G2WaterWaveComponent implements OnDestroy, OnChanges, OnInit {\r\n  // region: fields\r\n\r\n  _title = '';\r\n  _titleTpl: TemplateRef<any>;\r\n  @Input()\r\n  set title(value: string | TemplateRef<any>) {\r\n    if (value instanceof TemplateRef) {\r\n      this._title = null;\r\n      this._titleTpl = value;\r\n    } else this._title = value;\r\n  }\r\n\r\n  @Input() color = '#1890FF';\r\n\r\n  @Input()\r\n  get height() {\r\n    return this._height;\r\n  }\r\n  set height(value: any) {\r\n    this._height = coerceNumberProperty(value);\r\n  }\r\n  private _height = 160;\r\n\r\n  @Input()\r\n  get percent() {\r\n    return this._percent;\r\n  }\r\n  set percent(value: any) {\r\n    this._percent = coerceNumberProperty(value);\r\n  }\r\n  private _percent: number;\r\n\r\n  // endregion\r\n\r\n  @ViewChild('container') node: ElementRef;\r\n\r\n  initFlag = false;\r\n  timer: any;\r\n\r\n  constructor(\r\n    private el: ElementRef,\r\n    private renderer: Renderer2,\r\n    private cd: ChangeDetectorRef,\r\n  ) {}\r\n\r\n  renderChart() {\r\n    const data = this.percent / 100;\r\n    if (!data) return;\r\n\r\n    this.node.nativeElement.innerHTML = '';\r\n    const self = this;\r\n\r\n    const canvas = this.node.nativeElement as HTMLCanvasElement;\r\n    const ctx = canvas.getContext('2d');\r\n\r\n    const canvasWidth = canvas.width;\r\n    const canvasHeight = canvas.height;\r\n    const radius = canvasWidth / 2;\r\n    const lineWidth = 2;\r\n    const cR = radius - lineWidth;\r\n\r\n    ctx.beginPath();\r\n    ctx.lineWidth = lineWidth * 2;\r\n\r\n    const axisLength = canvasWidth - lineWidth;\r\n    const unit = axisLength / 8;\r\n    const range = 0.2; // 振幅\r\n    let currRange = range;\r\n    const xOffset = lineWidth;\r\n    let sp = 0; // 周期偏移量\r\n    let currData = 0;\r\n    const waveupsp = 0.005; // 水波上涨速度\r\n\r\n    let arcStack = [];\r\n    const bR = radius - lineWidth;\r\n    const circleOffset = -(Math.PI / 2);\r\n    let circleLock = true;\r\n\r\n    for (\r\n      let i = circleOffset;\r\n      i < circleOffset + 2 * Math.PI;\r\n      i += 1 / (8 * Math.PI)\r\n    ) {\r\n      arcStack.push([radius + bR * Math.cos(i), radius + bR * Math.sin(i)]);\r\n    }\r\n\r\n    const cStartPoint = arcStack.shift();\r\n    ctx.strokeStyle = this.color;\r\n    ctx.moveTo(cStartPoint[0], cStartPoint[1]);\r\n\r\n    function drawSin() {\r\n      ctx.beginPath();\r\n      ctx.save();\r\n\r\n      const sinStack = [];\r\n      for (let i = xOffset; i <= xOffset + axisLength; i += 20 / axisLength) {\r\n        const x = sp + (xOffset + i) / unit;\r\n        const y = Math.sin(x) * currRange;\r\n        const dx = i;\r\n        const dy = 2 * cR * (1 - currData) + (radius - cR) - unit * y;\r\n\r\n        ctx.lineTo(dx, dy);\r\n        sinStack.push([dx, dy]);\r\n      }\r\n\r\n      const startPoint = sinStack.shift();\r\n\r\n      ctx.lineTo(xOffset + axisLength, canvasHeight);\r\n      ctx.lineTo(xOffset, canvasHeight);\r\n      ctx.lineTo(startPoint[0], startPoint[1]);\r\n\r\n      const gradient = ctx.createLinearGradient(0, 0, 0, canvasHeight);\r\n      gradient.addColorStop(0, '#ffffff');\r\n      gradient.addColorStop(1, '#1890FF');\r\n      ctx.fillStyle = gradient;\r\n      ctx.fill();\r\n      ctx.restore();\r\n    }\r\n\r\n    function render() {\r\n      ctx.clearRect(0, 0, canvasWidth, canvasHeight);\r\n      if (circleLock) {\r\n        if (arcStack.length) {\r\n          const temp = arcStack.shift();\r\n          ctx.lineTo(temp[0], temp[1]);\r\n          ctx.stroke();\r\n        } else {\r\n          circleLock = false;\r\n          ctx.lineTo(cStartPoint[0], cStartPoint[1]);\r\n          ctx.stroke();\r\n          arcStack = null;\r\n\r\n          ctx.globalCompositeOperation = 'destination-over';\r\n          ctx.beginPath();\r\n          ctx.lineWidth = lineWidth;\r\n          ctx.arc(radius, radius, bR, 0, 2 * Math.PI, true);\r\n\r\n          ctx.beginPath();\r\n          ctx.save();\r\n          ctx.arc(radius, radius, radius - 3 * lineWidth, 0, 2 * Math.PI, true);\r\n\r\n          ctx.restore();\r\n          ctx.clip();\r\n          ctx.fillStyle = '#1890FF';\r\n        }\r\n      } else {\r\n        if (data >= 0.85) {\r\n          if (currRange > range / 4) {\r\n            const t = range * 0.01;\r\n            currRange -= t;\r\n          }\r\n        } else if (data <= 0.1) {\r\n          if (currRange < range * 1.5) {\r\n            const t = range * 0.01;\r\n            currRange += t;\r\n          }\r\n        } else {\r\n          if (currRange <= range) {\r\n            const t = range * 0.01;\r\n            currRange += t;\r\n          }\r\n          if (currRange >= range) {\r\n            const t = range * 0.01;\r\n            currRange -= t;\r\n          }\r\n        }\r\n        if (data - currData > 0) {\r\n          currData += waveupsp;\r\n        }\r\n        if (data - currData < 0) {\r\n          currData -= waveupsp;\r\n        }\r\n\r\n        sp += 0.07;\r\n        drawSin();\r\n      }\r\n      self.timer = requestAnimationFrame(render);\r\n    }\r\n\r\n    render();\r\n  }\r\n\r\n  uninstall() {}\r\n\r\n  private updateRadio(radio: number) {\r\n    this.renderer.setStyle(\r\n      this.el.nativeElement,\r\n      'transform',\r\n      `scale(${radio})`,\r\n    );\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.initFlag = true;\r\n    this.cd.detectChanges();\r\n    this.updateRadio(1);\r\n    this.installResizeEvent();\r\n    setTimeout(() => this.resize(), 130);\r\n  }\r\n\r\n  ngOnChanges(\r\n    changes: { [P in keyof this]?: SimpleChange } & SimpleChanges,\r\n  ): void {\r\n    if (this.initFlag) {\r\n      this.cd.detectChanges();\r\n      this.renderChart();\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.timer) cancelAnimationFrame(this.timer);\r\n    this.uninstallResizeEvent();\r\n    this.uninstall();\r\n  }\r\n\r\n  // region: resize\r\n\r\n  private autoHideXLabels = false;\r\n  private scroll$: Subscription = null;\r\n  private installResizeEvent() {\r\n    if (this.scroll$) return;\r\n\r\n    this.scroll$ = <any>FromEventObservable.create(window, 'resize')\r\n      .pipe(debounceTime(500))\r\n      .subscribe(() => this.resize());\r\n  }\r\n\r\n  private uninstallResizeEvent() {\r\n    if (this.scroll$) this.scroll$.unsubscribe();\r\n  }\r\n\r\n  resize() {\r\n    const { offsetWidth } = this.el.nativeElement.parentNode;\r\n    this.updateRadio(offsetWidth < this.height ? offsetWidth / this.height : 1);\r\n    this.renderChart();\r\n  }\r\n\r\n  // endregion\r\n}\r\n"]}