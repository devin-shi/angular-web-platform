{"version":3,"file":"reuse-tab.service.js","sourceRoot":"","sources":["../../../../../packages/abc/reuse-tab/reuse-tab.service.ts"],"names":[],"mappings":"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","sourcesContent":["import {\r\n  Injectable,\r\n  OnDestroy,\r\n  Optional,\r\n  Injector,\r\n  Inject,\r\n} from '@angular/core';\r\nimport {\r\n  ActivatedRouteSnapshot,\r\n  DetachedRouteHandle,\r\n  ActivatedRoute,\r\n} from '@angular/router';\r\nimport { BehaviorSubject } from 'rxjs/BehaviorSubject';\r\nimport { Observable } from 'rxjs/Observable';\r\nimport { filter } from 'rxjs/operators';\r\nimport { Subscription } from 'rxjs/Subscription';\r\n\r\nimport { MenuService, ALAIN_I18N_TOKEN, AlainI18NService } from '@delon/theme';\r\n\r\nimport {\r\n  ReuseTabCached,\r\n  ReuseTabMatchMode,\r\n  ReuseTabNotify,\r\n  ReuseTitle,\r\n} from './interface';\r\n\r\n/**\r\n * 路由复用类，提供复用所需要一些基本接口\r\n *\r\n * **注：** 所有缓存数据来源于路由离开后才会产生\r\n */\r\n@Injectable()\r\nexport class ReuseTabService implements OnDestroy {\r\n  private _max = 10;\r\n  private _debug = false;\r\n  private _mode = ReuseTabMatchMode.Menu;\r\n  private _excludes: RegExp[] = [];\r\n  private _cachedChange: BehaviorSubject<ReuseTabNotify> = new BehaviorSubject<\r\n    ReuseTabNotify\r\n  >(null);\r\n  private _cached: ReuseTabCached[] = [];\r\n  private _titleCached: { [url: string]: ReuseTitle } = {};\r\n  private _closableCached: { [url: string]: boolean } = {};\r\n  private removeUrlBuffer: string;\r\n\r\n  // region: public\r\n\r\n  /** 允许最多复用多少个页面，取值范围 `2-100` */\r\n  set max(value: number) {\r\n    this._max = Math.min(Math.max(value, 2), 100);\r\n    for (let i = this._cached.length; i > this._max; i--) {\r\n      this._cached.pop();\r\n    }\r\n  }\r\n  /** 设置匹配模式 */\r\n  set mode(value: ReuseTabMatchMode) {\r\n    this._mode = value;\r\n  }\r\n  get mode() {\r\n    return this._mode;\r\n  }\r\n  /** 设置Debug模式 */\r\n  set debug(value: boolean) {\r\n    this._debug = value;\r\n  }\r\n  get debug() {\r\n    return this._debug;\r\n  }\r\n  /** 排除规则，限 `mode=URL` */\r\n  set excludes(values: RegExp[]) {\r\n    if (!values) return;\r\n    this._excludes = values;\r\n  }\r\n  get excludes() {\r\n    return this._excludes;\r\n  }\r\n  /** 获取已缓存的路由 */\r\n  get items(): ReuseTabCached[] {\r\n    return this._cached;\r\n  }\r\n  /** 获取当前缓存的路由总数 */\r\n  get count() {\r\n    return this._cached.length;\r\n  }\r\n  /** 订阅缓存变更通知 */\r\n  get change(): Observable<ReuseTabNotify> {\r\n    return this._cachedChange.asObservable(); // .pipe(filter(w => w !== null));\r\n  }\r\n  /** 自定义当前标题 */\r\n  set title(value: string | ReuseTitle) {\r\n    const curUrl = this.getUrl(this.injector.get(ActivatedRoute).snapshot);\r\n    if (typeof value === 'string') value = { text: value };\r\n    this._titleCached[curUrl] = value;\r\n    this.di('update current tag title: ', value);\r\n    this._cachedChange.next({\r\n      active: 'title',\r\n      title: value,\r\n      list: this._cached,\r\n    });\r\n  }\r\n  /** 获取指定路径缓存所在位置，`-1` 表示无缓存 */\r\n  index(url: string): number {\r\n    return this._cached.findIndex(w => w.url === url);\r\n  }\r\n  /** 获取指定路径缓存是否存在 */\r\n  exists(url: string): boolean {\r\n    return this.index(url) !== -1;\r\n  }\r\n  /** 获取指定路径缓存 */\r\n  get(url: string): ReuseTabCached {\r\n    return url ? this._cached.find(w => w.url === url) || null : null;\r\n  }\r\n  private remove(url: string | number, includeNonCloseable: boolean): boolean {\r\n    const idx = typeof url === 'string' ? this.index(url) : url;\r\n    const item = idx !== -1 ? this._cached[idx] : null;\r\n    if (!item || (!includeNonCloseable && !item.closable)) return false;\r\n\r\n    this.destroy(item._handle);\r\n\r\n    this._cached.splice(idx, 1);\r\n    delete this._titleCached[url];\r\n    return true;\r\n  }\r\n  /**\r\n   * 根据URL移除标签\r\n   *\r\n   * @param [includeNonCloseable=false] 是否强制包含不可关闭\r\n   */\r\n  close(url: string, includeNonCloseable = false) {\r\n    this.removeUrlBuffer = url;\r\n\r\n    this.remove(url, includeNonCloseable);\r\n\r\n    this._cachedChange.next({ active: 'close', url, list: this._cached });\r\n\r\n    this.di('close tag', url);\r\n    return true;\r\n  }\r\n  /**\r\n   * 清除右边\r\n   *\r\n   * @param [includeNonCloseable=false] 是否强制包含不可关闭\r\n   */\r\n  closeRight(url: string, includeNonCloseable = false) {\r\n    const start = this.index(url);\r\n    for (let i = this.count - 1; i > start; i--) {\r\n      this.remove(i, includeNonCloseable);\r\n    }\r\n\r\n    this.removeUrlBuffer = null;\r\n\r\n    this._cachedChange.next({ active: 'closeRight', url, list: this._cached });\r\n\r\n    this.di('close right tages', url);\r\n    return true;\r\n  }\r\n  /**\r\n   * 清除所有缓存\r\n   *\r\n   * @param [includeNonCloseable=false] 是否强制包含不可关闭\r\n   */\r\n  clear(includeNonCloseable = false) {\r\n    this._cached.forEach(w => {\r\n      if (!includeNonCloseable && w.closable) this.destroy(w._handle);\r\n    });\r\n    this._cached = this._cached.filter(\r\n      w => !includeNonCloseable && !w.closable,\r\n    );\r\n\r\n    this.removeUrlBuffer = null;\r\n\r\n    this._cachedChange.next({ active: 'clear', list: this._cached });\r\n\r\n    this.di('clear all catch');\r\n  }\r\n  /**\r\n   * 移动缓存数据\r\n   * @param url 要移动的URL地址\r\n   * @param position 新位置，下标从 `0` 开始\r\n   *\r\n   * @example\r\n   * ```\r\n   * // source\r\n   * [ '/a/1', '/a/2', '/a/3', '/a/4', '/a/5' ]\r\n   * move('/a/1', 2);\r\n   * // output\r\n   * [ '/a/2', '/a/3', '/a/1', '/a/4', '/a/5' ]\r\n   * move('/a/1', -1);\r\n   * // output\r\n   * [ '/a/2', '/a/3', '/a/4', '/a/5', '/a/1' ]\r\n   * ```\r\n   */\r\n  move(url: string, position: number) {\r\n    const start = this._cached.findIndex(w => w.url === url);\r\n    if (start === -1) return;\r\n    const data = this._cached.slice();\r\n    data.splice(\r\n      position < 0 ? data.length + position : position,\r\n      0,\r\n      data.splice(start, 1)[0],\r\n    );\r\n    this._cached = data;\r\n    this._cachedChange.next({\r\n      active: 'move',\r\n      url,\r\n      position,\r\n      list: this._cached,\r\n    });\r\n  }\r\n  /**\r\n   * 获取标题，顺序如下：\r\n   *\r\n   * 1. 组件内使用 `ReuseTabService.title = 'new title'` 重新指定文本\r\n   * 2. 路由配置中 data 属性中包含 titleI18n > title\r\n   * 3. 菜单数据中 text 属性\r\n   *\r\n   * @param url 指定URL\r\n   * @param route 指定路由快照\r\n   */\r\n  getTitle(url: string, route?: ActivatedRouteSnapshot): ReuseTitle {\r\n    if (this._titleCached[url]) return this._titleCached[url];\r\n\r\n    if (route && route.data && (route.data.titleI18n || route.data.title))\r\n      return <ReuseTitle>{ text: route.data.title, i18n: route.data.titleI18n };\r\n\r\n    const menu = this.mode !== ReuseTabMatchMode.URL ? this.getMenu(url) : null;\r\n    return menu ? { text: menu.text, i18n: menu.i18n } : { text: url };\r\n  }\r\n\r\n  /**\r\n   * 清除标题缓存\r\n   */\r\n  clearTitleCached() {\r\n    this._titleCached = {};\r\n  }\r\n  /** 自定义当前 `closable` 状态 */\r\n  set closable(value: boolean) {\r\n    const curUrl = this.getUrl(this.injector.get(ActivatedRoute).snapshot);\r\n    this._closableCached[curUrl] = value;\r\n    this.di('update current tag closable: ', value);\r\n    this._cachedChange.next({\r\n      active: 'closable',\r\n      closable: value,\r\n      list: this._cached,\r\n    });\r\n  }\r\n  /**\r\n   * 获取 `closable` 状态，顺序如下：\r\n   *\r\n   * 1. 组件内使用 `ReuseTabService.closable = true` 重新指定 `closable` 状态\r\n   * 2. 路由配置中 data 属性中包含 `reuseClosable`\r\n   * 3. 菜单数据中 `reuseClosable` 属性\r\n   *\r\n   * @param url 指定URL\r\n   * @param route 指定路由快照\r\n   */\r\n  getClosable(url: string, route?: ActivatedRouteSnapshot): boolean {\r\n    if (typeof this._closableCached[url] !== 'undefined')\r\n      return this._closableCached[url];\r\n\r\n    if (route && route.data && typeof route.data.reuseClosable === 'boolean')\r\n      return route.data.reuseClosable;\r\n\r\n    const menu = this.mode !== ReuseTabMatchMode.URL ? this.getMenu(url) : null;\r\n    if (menu && typeof menu.reuseClosable === 'boolean')\r\n      return menu.reuseClosable;\r\n\r\n    return true;\r\n  }\r\n  /**\r\n   * 清空 `closable` 缓存\r\n   */\r\n  clearClosableCached() {\r\n    this._closableCached = {};\r\n  }\r\n  getTruthRoute(route: ActivatedRouteSnapshot) {\r\n    let next = route;\r\n    while (next.firstChild) next = next.firstChild;\r\n    return next;\r\n  }\r\n  /**\r\n   * 根据快照获取URL地址\r\n   */\r\n  getUrl(route: ActivatedRouteSnapshot): string {\r\n    let next = this.getTruthRoute(route);\r\n    const segments = [];\r\n    while (next) {\r\n      segments.push(next.url.join('/'));\r\n      next = next.parent;\r\n    }\r\n    const url =\r\n      '/' +\r\n      segments\r\n        .filter(i => i)\r\n        .reverse()\r\n        .join('/');\r\n    return url;\r\n  }\r\n  /**\r\n   * 检查快照是否允许被复用\r\n   */\r\n  can(route: ActivatedRouteSnapshot): boolean {\r\n    const url = this.getUrl(route);\r\n    if (url === this.removeUrlBuffer) return false;\r\n\r\n    if (route.data && typeof route.data.reuse === 'boolean')\r\n      return route.data.reuse;\r\n\r\n    if (this.mode !== ReuseTabMatchMode.URL) {\r\n      const menu = this.getMenu(url);\r\n      if (!menu) return false;\r\n      if (this.mode === ReuseTabMatchMode.Menu) {\r\n        if (menu.reuse === false) return false;\r\n      } else {\r\n        if (!menu.reuse || menu.reuse !== true) return false;\r\n      }\r\n      return true;\r\n    }\r\n    return this._excludes.findIndex(r => r.test(url)) === -1;\r\n  }\r\n  /**\r\n   * 刷新，触发一个 refresh 类型事件\r\n   */\r\n  refresh(data?: any) {\r\n    this._cachedChange.next({ active: 'refresh', data });\r\n  }\r\n  // endregion\r\n\r\n  // region: privates\r\n\r\n  private destroy(_handle: any) {\r\n    if (_handle && _handle.componentRef && _handle.componentRef.destroy)\r\n      _handle.componentRef.destroy();\r\n  }\r\n\r\n  private di(...args) {\r\n    if (!this.debug) return;\r\n    // tslint:disable-next-line:no-console\r\n    console.warn(...args);\r\n  }\r\n\r\n  // endregion\r\n\r\n  constructor(\r\n    private injector: Injector,\r\n    @Optional() private menuService: MenuService,\r\n  ) {}\r\n\r\n  private getMenu(url: string) {\r\n    const menus = this.menuService ? this.menuService.getPathByUrl(url) : [];\r\n    if (!menus || menus.length === 0) return null;\r\n    return menus.pop();\r\n  }\r\n\r\n  private runHook(method: string, url: string, comp: any) {\r\n    if (comp.instance && comp.instance.hasOwnProperty(method))\r\n      comp.instance[method]();\r\n  }\r\n\r\n  private hasInValidRoute(route: ActivatedRouteSnapshot) {\r\n    return (\r\n      !route.routeConfig ||\r\n      route.routeConfig.loadChildren ||\r\n      route.routeConfig.children\r\n    );\r\n  }\r\n\r\n  /**\r\n   * 决定是否允许路由复用，若 `true` 会触发 `store`\r\n   */\r\n  shouldDetach(route: ActivatedRouteSnapshot): boolean {\r\n    if (this.hasInValidRoute(route)) return false;\r\n    this.di('#shouldDetach', this.can(route), this.getUrl(route));\r\n    return this.can(route);\r\n  }\r\n\r\n  /**\r\n   * 存储\r\n   */\r\n  store(_snapshot: ActivatedRouteSnapshot, _handle: any) {\r\n    if (this.count >= this._max) this._cached.shift();\r\n    const url = this.getUrl(_snapshot);\r\n    const idx = this.index(url);\r\n\r\n    const item: ReuseTabCached = {\r\n      title: this.getTitle(url, _snapshot),\r\n      closable: this.getClosable(url, _snapshot),\r\n      url,\r\n      _snapshot,\r\n      _handle,\r\n    };\r\n    if (idx === -1) {\r\n      this._cached.push(item);\r\n    } else {\r\n      this._cached[idx] = item;\r\n    }\r\n    this.removeUrlBuffer = null;\r\n\r\n    this.di('#store', idx === -1 ? '[new]' : '[override]', url);\r\n\r\n    if (_handle && _handle.componentRef) {\r\n      this.runHook('_onReuseDestroy', url, _handle.componentRef);\r\n    }\r\n\r\n    this._cachedChange.next({ active: 'add', item, list: this._cached });\r\n  }\r\n\r\n  /**\r\n   * 决定是否允许应用缓存数据\r\n   */\r\n  shouldAttach(route: ActivatedRouteSnapshot): boolean {\r\n    if (this.hasInValidRoute(route)) return false;\r\n    const url = this.getUrl(route);\r\n    const data = this.get(url);\r\n    const ret = !!(data && data._handle);\r\n    this.di('#shouldAttach', ret, url);\r\n    return ret;\r\n  }\r\n\r\n  /**\r\n   * 提取复用数据\r\n   */\r\n  retrieve(route: ActivatedRouteSnapshot): {} {\r\n    if (this.hasInValidRoute(route)) return null;\r\n    const url = this.getUrl(route);\r\n    const data = this.get(url);\r\n    const ret = (data && data._handle) || null;\r\n    this.di('#retrieve', url, ret);\r\n    if (ret && ret.componentRef) {\r\n      this.runHook('_onReuseInit', url, ret.componentRef);\r\n    }\r\n    return ret;\r\n  }\r\n\r\n  /**\r\n   * 决定是否应该进行复用路由处理\r\n   */\r\n  shouldReuseRoute(\r\n    future: ActivatedRouteSnapshot,\r\n    curr: ActivatedRouteSnapshot,\r\n  ): boolean {\r\n    let ret = future.routeConfig === curr.routeConfig;\r\n    if (!ret) return false;\r\n\r\n    const path = ((future.routeConfig && future.routeConfig.path) ||\r\n      '') as string;\r\n    if (path.length > 0 && ~path.indexOf(':')) {\r\n      const futureUrl = this.getUrl(future);\r\n      const currUrl = this.getUrl(curr);\r\n      ret = futureUrl === currUrl;\r\n    }\r\n    this.di('=====================');\r\n    this.di(\r\n      '#shouldReuseRoute',\r\n      ret,\r\n      `${this.getUrl(curr)}=>${this.getUrl(future)}`,\r\n      future,\r\n      curr,\r\n    );\r\n    return ret;\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this._cached = [];\r\n    this._cachedChange.unsubscribe();\r\n  }\r\n}\r\n"]}