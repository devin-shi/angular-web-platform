{"version":3,"file":"full-content.component.js","sourceRoot":"","sources":["../../../../../packages/abc/full-content/full-content.component.ts"],"names":[],"mappings":"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","sourcesContent":["import {\r\n  Component,\r\n  ElementRef,\r\n  ChangeDetectionStrategy,\r\n  ChangeDetectorRef,\r\n  Input,\r\n  Output,\r\n  EventEmitter,\r\n  OnChanges,\r\n  SimpleChanges,\r\n  SimpleChange,\r\n  OnInit,\r\n  Inject,\r\n  HostBinding,\r\n  OnDestroy,\r\n  AfterViewInit,\r\n} from '@angular/core';\r\nimport {\r\n  coerceBooleanProperty,\r\n  coerceNumberProperty,\r\n} from '@angular/cdk/coercion';\r\nimport { DOCUMENT } from '@angular/platform-browser';\r\nimport { Subscription } from 'rxjs/Subscription';\r\nimport { FromEventObservable } from 'rxjs/observable/FromEventObservable';\r\nimport { debounceTime, filter, distinct } from 'rxjs/operators';\r\nimport { FullContentService } from './full-content.service';\r\nimport { Router, ActivationStart, ActivationEnd } from '@angular/router';\r\n\r\nconst cls = `ad-full-content-wrap`;\r\nconst fsCls = `ad-full-content-fs`;\r\nconst hideTitleCls = `ad-full-content-ht`;\r\n\r\n@Component({\r\n  selector: 'full-content',\r\n  template: `<ng-content></ng-content>`,\r\n  host: { '[class.ad-full-content]': 'true' },\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class FullContentComponent\r\n  implements AfterViewInit, OnInit, OnChanges, OnDestroy {\r\n  private bodyEl: HTMLElement;\r\n  private inited = false;\r\n  private srv$: Subscription;\r\n  private route$: Subscription;\r\n  private id = `_full-content-${Math.random()\r\n    .toString(36)\r\n    .substring(2)}`;\r\n\r\n  @HostBinding('style.height.px') _height = 0;\r\n\r\n  // region: fields\r\n\r\n  @Input()\r\n  get fullscreen() {\r\n    return this._fullscreen;\r\n  }\r\n  set fullscreen(value: any) {\r\n    this._fullscreen = coerceBooleanProperty(value);\r\n  }\r\n  private _fullscreen;\r\n\r\n  @Input()\r\n  get hideTitle() {\r\n    return this._hideTitle;\r\n  }\r\n  set hideTitle(value: any) {\r\n    this._hideTitle = coerceBooleanProperty(value);\r\n  }\r\n  private _hideTitle = true;\r\n\r\n  @Input()\r\n  get padding() {\r\n    return this._padding;\r\n  }\r\n  set padding(value: any) {\r\n    this._padding = coerceNumberProperty(value);\r\n  }\r\n  private _padding = 24;\r\n\r\n  @Output()\r\n  fullscreenChange: EventEmitter<boolean> = new EventEmitter<boolean>();\r\n\r\n  // endregion\r\n\r\n  constructor(\r\n    private el: ElementRef,\r\n    private router: Router,\r\n    private cd: ChangeDetectorRef,\r\n    private srv: FullContentService,\r\n    @Inject(DOCUMENT) private doc: any,\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.inited = true;\r\n    this.bodyEl = this.doc.querySelector('body');\r\n    this.bodyEl.classList.add(cls);\r\n    (this.el.nativeElement as HTMLElement).id = this.id;\r\n    this.update();\r\n    this.installResizeEvent();\r\n    this.srv$ = <any>this.srv.change.subscribe(res => {\r\n      if (res) this.toggle();\r\n    });\r\n    this.route$ = <any>this.router.events\r\n      .pipe(\r\n        filter(\r\n          (e: any) =>\r\n            e instanceof ActivationStart || e instanceof ActivationEnd,\r\n        ),\r\n        debounceTime(200),\r\n      )\r\n      .subscribe(e => {\r\n        if (!!document.querySelector('#' + this.id)) {\r\n          this.bodyEl.classList.add(cls);\r\n          this.updateFsCls();\r\n        } else {\r\n          this.bodyEl.classList.remove(cls, fsCls, hideTitleCls);\r\n        }\r\n      });\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    setTimeout(() => this.updateHeight());\r\n  }\r\n\r\n  private updateFsCls() {\r\n    if (this.fullscreen) {\r\n      this.bodyEl.classList.add(fsCls);\r\n      if (this.hideTitle) this.bodyEl.classList.add(hideTitleCls);\r\n    } else {\r\n      this.bodyEl.classList.remove(fsCls);\r\n      if (this.hideTitle) this.bodyEl.classList.remove(hideTitleCls);\r\n    }\r\n  }\r\n\r\n  private update() {\r\n    this.updateFsCls();\r\n    this.fullscreenChange.emit(this.fullscreen);\r\n  }\r\n\r\n  private updateHeight() {\r\n    this._height =\r\n      this.bodyEl.getBoundingClientRect().height -\r\n      (this.el.nativeElement as HTMLElement).getBoundingClientRect().top -\r\n      this.padding;\r\n    this.cd.detectChanges();\r\n  }\r\n\r\n  toggle() {\r\n    this.fullscreen = !this.fullscreen;\r\n    this.update();\r\n    this.updateHeight();\r\n  }\r\n\r\n  ngOnChanges(\r\n    changes: { [P in keyof this]?: SimpleChange } & SimpleChanges,\r\n  ): void {\r\n    if (this.inited) this.update();\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.bodyEl.classList.remove(cls, fsCls, hideTitleCls);\r\n    this.uninstallResizeEvent();\r\n    this.srv$.unsubscribe();\r\n    this.route$.unsubscribe();\r\n  }\r\n\r\n  // region: resize\r\n\r\n  private scroll$: Subscription = null;\r\n  private installResizeEvent() {\r\n    this.scroll$ = <any>FromEventObservable.create(window, 'resize')\r\n      .pipe(debounceTime(200))\r\n      .subscribe(() => this.updateHeight());\r\n  }\r\n\r\n  private uninstallResizeEvent() {\r\n    this.scroll$.unsubscribe();\r\n  }\r\n\r\n  // endregion\r\n}\r\n"]}