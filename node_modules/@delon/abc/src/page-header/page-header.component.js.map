{"version":3,"file":"page-header.component.js","sourceRoot":"","sources":["../../../../../packages/abc/page-header/page-header.component.ts"],"names":[],"mappings":";;;;AAAA,OAAO,EACL,SAAS,EACT,KAAK,EACL,WAAW,EACX,YAAY,EAGZ,MAAM,EACN,QAAQ,EAGR,SAAS,EACT,UAAU,EAEV,SAAS,GACV,MAAM,eAAe,CAAC;AACvB,OAAO,EAAkB,MAAM,EAAE,MAAM,iBAAiB,CAAC;AACzD,OAAO,EAAE,qBAAqB,EAAE,MAAM,uBAAuB,CAAC;AAC9D,OAAO,EAAE,WAAW,EAAE,gBAAgB,EAAoB,MAAM,cAAc,CAAC;AAC/E,OAAO,EAAE,OAAO,EAAE,MAAM,aAAa,CAAC;AAEtC,OAAO,EAAE,kBAAkB,EAAE,MAAM,sBAAsB,CAAC;;IAyExD,YAAY;IAEZ,6BACE,GAAuB,EACf,UACA,OACY,SAGZ;QALA,aAAQ,GAAR,QAAQ;QACR,UAAK,GAAL,KAAK;QACO,YAAO,GAAP,OAAO;QAGnB,YAAO,GAAP,OAAO;+BAzBS,IAAI;qBAEf,EAAE;QAyBf,MAAM,CAAC,MAAM,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;KAC1B;0BAlCG,+CAAc;;;;;;YAChB,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC;;;;;;QAE9B,UAAmB,KAAU;YAC3B,IAAI,CAAC,eAAe,GAAG,qBAAqB,CAAC,KAAK,CAAC,CAAC;SACrD;;;;;;;IA+BD,2CAAa;;;IAAb;QAAA,iBAwBC;QAvBC,EAAE,CAAC,CAAC,IAAI,CAAC,UAAU,IAAI,CAAC,IAAI,CAAC,cAAc,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;YAAC,MAAM,CAAC;QACrE,qBAAM,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QACxD,EAAE,CAAC,CAAC,KAAK,CAAC,MAAM,IAAI,CAAC,CAAC;YAAC,MAAM,CAAC;QAC9B,qBAAM,KAAK,GAAU,EAAE,CAAC;QACxB,KAAK,CAAC,OAAO,CAAC,UAAA,IAAI;YAChB,EAAE,CAAC,CAAC,OAAO,IAAI,CAAC,gBAAgB,KAAK,WAAW,IAAI,IAAI,CAAC,gBAAgB,CAAC;gBACxE,MAAM,CAAC;YACT,qBAAI,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC;YACtB,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,IAAI,KAAI,CAAC,OAAO,CAAC;gBAAC,KAAK,GAAG,KAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACrE,KAAK,CAAC,IAAI,CAAC,EAAE,KAAK,OAAA,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;SACvD,CAAC,CAAC;;QAEH,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;YACd,KAAK,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE;gBACjB,KAAK,EACH,CAAC,IAAI,CAAC,SAAS;oBACb,IAAI,CAAC,OAAO;oBACZ,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;oBACrC,IAAI,CAAC,IAAI;gBACX,IAAI,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC;aACvB,CAAC,CAAC;SACJ;QACD,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;KACpB;;;;IAED,0CAAY;;;IAAZ;QACE,EAAE,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;YACvC,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,QAAQ,EAAE,EAAE,CAAC,CAAC;SACrE;QAAC,IAAI,CAAC,CAAC;YACN,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,QAAQ,CAAC,CAAC;SACpE;KACF;;;;IAED,sCAAQ;;;IAAR;QACE,IAAI,CAAC,aAAa,EAAE,CAAC;KACtB;;;;IAED,6CAAe;;;IAAf;QACE,IAAI,CAAC,YAAY,EAAE,CAAC;KACrB;;;;;IAED,yCAAW;;;;IAAX,UACE,OAA6D;QAE7D,EAAE,CAAC,CAAC,OAAO,CAAC,cAAc,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,WAAW,CAAC;YAChE,IAAI,CAAC,aAAa,EAAE,CAAC;KACxB;;gBApIF,SAAS,SAAC;oBACT,QAAQ,EAAE,aAAa;oBACvB,QAAQ,EAAE,qpCAuBT;oBACD,IAAI,EAAE;wBACJ,wBAAwB,EAAE,MAAM;wBAChC,wBAAwB,EAAE,MAAM;qBACjC;oBACD,mBAAmB,EAAE,KAAK;iBAC3B;;;;gBAjCQ,kBAAkB;gBAPzB,SAAS;gBAEc,MAAM;gBAEtB,WAAW,uBAkFf,QAAQ;gDACR,QAAQ,YACR,MAAM,SAAC,gBAAgB;;;2BA9CzB,SAAS,SAAC,QAAQ;0BAIlB,KAAK;yBAEL,KAAK;8BAEL,KAAK;8BAEL,KAAK;mCAKL,KAAK;+BAWL,YAAY,SAAC,YAAY;yBAEzB,YAAY,SAAC,MAAM;2BAEnB,YAAY,SAAC,QAAQ;4BAErB,YAAY,SAAC,SAAS;0BAEtB,YAAY,SAAC,OAAO;wBAEpB,YAAY,SAAC,KAAK;;8BA5FrB;;SAuDa,mBAAmB","sourcesContent":["import {\n  Component,\n  Input,\n  TemplateRef,\n  ContentChild,\n  OnInit,\n  OnChanges,\n  Inject,\n  Optional,\n  SimpleChange,\n  SimpleChanges,\n  ViewChild,\n  ElementRef,\n  AfterViewInit,\n  Renderer2,\n} from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { coerceBooleanProperty } from '@angular/cdk/coercion';\nimport { MenuService, ALAIN_I18N_TOKEN, AlainI18NService } from '@delon/theme';\nimport { isEmpty } from '@delon/util';\n\nimport { AdPageHeaderConfig } from './page-header.config';\n\n@Component({\n  selector: 'page-header',\n  template: `\n  <ng-container *ngIf=\"!breadcrumb; else breadcrumb\">\n    <nz-breadcrumb *ngIf=\"paths && paths.length > 0\">\n      <nz-breadcrumb-item *ngFor=\"let i of paths\">\n        <ng-container *ngIf=\"i.link\"><a [routerLink]=\"i.link\">{{i.title}}</a></ng-container>\n        <ng-container *ngIf=\"!i.link\">{{i.title}}</ng-container>\n      </nz-breadcrumb-item>\n    </nz-breadcrumb>\n  </ng-container>\n  <div class=\"detail\">\n    <div *ngIf=\"logo\" class=\"logo\"><ng-template [ngTemplateOutlet]=\"logo\"></ng-template></div>\n    <div class=\"main\">\n      <div class=\"row\">\n        <h1 *ngIf=\"title\" class=\"title\">{{title}}</h1>\n        <div *ngIf=\"action\" class=\"action\"><ng-template [ngTemplateOutlet]=\"action\"></ng-template></div>\n      </div>\n      <div class=\"row\">\n        <div class=\"desc\" (cdkObserveContent)=\"checkContent()\" #conTpl><ng-content></ng-content><ng-template [ngTemplateOutlet]=\"content\"></ng-template></div>\n        <div *ngIf=\"extra\" class=\"extra\"><ng-template [ngTemplateOutlet]=\"extra\"></ng-template></div>\n      </div>\n    </div>\n  </div>\n  <ng-template [ngTemplateOutlet]=\"tab\"></ng-template>\n  `,\n  host: {\n    '[class.content__title]': 'true',\n    '[class.ad-page-header]': 'true',\n  },\n  preserveWhitespaces: false,\n})\nexport class PageHeaderComponent implements OnInit, OnChanges, AfterViewInit {\n  @ViewChild('conTpl') conTpl: ElementRef;\n\n  // region fields\n\n  @Input() title: string;\n\n  @Input() home: string;\n\n  @Input() home_link: string;\n\n  @Input() home_i18n: string;\n\n  /**\n   * 自动生成导航，以当前路由从主菜单中定位\n   */\n  @Input()\n  get autoBreadcrumb() {\n    return this._autoBreadcrumb;\n  }\n  set autoBreadcrumb(value: any) {\n    this._autoBreadcrumb = coerceBooleanProperty(value);\n  }\n  private _autoBreadcrumb = true;\n\n  paths: any[] = [];\n\n  @ContentChild('breadcrumb') breadcrumb: TemplateRef<any>;\n\n  @ContentChild('logo') logo: TemplateRef<any>;\n\n  @ContentChild('action') action: TemplateRef<any>;\n\n  @ContentChild('content') content: TemplateRef<any>;\n\n  @ContentChild('extra') extra: TemplateRef<any>;\n\n  @ContentChild('tab') tab: TemplateRef<any>;\n\n  // endregion\n\n  constructor(\n    cog: AdPageHeaderConfig,\n    private renderer: Renderer2,\n    private route: Router,\n    @Optional() private menuSrv: MenuService,\n    @Optional()\n    @Inject(ALAIN_I18N_TOKEN)\n    private i18nSrv: AlainI18NService,\n  ) {\n    Object.assign(this, cog);\n  }\n\n  genBreadcrumb() {\n    if (this.breadcrumb || !this.autoBreadcrumb || !this.menuSrv) return;\n    const menus = this.menuSrv.getPathByUrl(this.route.url);\n    if (menus.length <= 0) return;\n    const paths: any[] = [];\n    menus.forEach(item => {\n      if (typeof item.hideInBreadcrumb !== 'undefined' && item.hideInBreadcrumb)\n        return;\n      let title = item.text;\n      if (item.i18n && this.i18nSrv) title = this.i18nSrv.fanyi(item.i18n);\n      paths.push({ title, link: item.link && [item.link] });\n    });\n    // add home\n    if (this.home) {\n      paths.splice(0, 0, {\n        title:\n          (this.home_i18n &&\n            this.i18nSrv &&\n            this.i18nSrv.fanyi(this.home_i18n)) ||\n          this.home,\n        link: [this.home_link],\n      });\n    }\n    this.paths = paths;\n  }\n\n  checkContent() {\n    if (isEmpty(this.conTpl.nativeElement)) {\n      this.renderer.setAttribute(this.conTpl.nativeElement, 'hidden', '');\n    } else {\n      this.renderer.removeAttribute(this.conTpl.nativeElement, 'hidden');\n    }\n  }\n\n  ngOnInit() {\n    this.genBreadcrumb();\n  }\n\n  ngAfterViewInit(): void {\n    this.checkContent();\n  }\n\n  ngOnChanges(\n    changes: { [P in keyof this]?: SimpleChange } & SimpleChanges,\n  ): void {\n    if (changes.autoBreadcrumb && !changes.autoBreadcrumb.firstChange)\n      this.genBreadcrumb();\n  }\n}\n"]}