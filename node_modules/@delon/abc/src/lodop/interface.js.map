{"version":3,"file":"interface.js","sourceRoot":"","sources":["../../../../../packages/abc/lodop/interface.ts"],"names":[],"mappings":"","sourcesContent":["export interface CLodop {\r\n  /** 建立打印机名单 */\r\n  Create_Printer_List(el: Element): void;\r\n\r\n  /** 建立纸张类型名单 */\r\n  Create_PageSize_List(el: Element, iPrintIndex: number): void;\r\n\r\n  /**\r\n   * 判断是否支持https协议的属性\r\n   *\r\n   * - 0 不支持\r\n   * - 1 支持\r\n   * - 2 支持且已启动（https服务需单独启动)\r\n   */\r\n  readonly HTTPS_STATUS: number;\r\n\r\n  /** 结果回调函数 */\r\n  On_Return: (taskID: string, value: boolean | string) => void;\r\n\r\n  /** 结果回调函数保留 */\r\n  readonly On_Return_Remain: boolean;\r\n}\r\n\r\nexport interface Lodop extends CLodop {\r\n  [key: string]: any;\r\n\r\n  /** 获得软件版本号 */\r\n  VERSION: string;\r\n\r\n  /**\r\n   * 打印初始化。初始化运行环境，清理异常打印遗留的系统资源，设定打印任务名。\r\n   *\r\n   * **建议或要求：**该函数与PRINT_INITA都有初始化功能，每个打印事务至少初始化一次，建议打印程序首先调用该函数。任务名要尽量区别于其它打印任务，譬如用“XX单位_XX管理信息系统_XX子系统_XX模块_XX打印作业”字样。\r\n   * 不希望最终用户更改打印布局时，则设strTaskName空。\r\n   *\r\n   * @param strTaskName 打印任务名\r\n   * @returns 返回逻辑真表示初始化成功，逻辑假表示初始化失败，失败原因有：前一个打印事务没有完成；操作系统没有添加打印机(驱动)等\r\n   */\r\n  PRINT_INIT(strTaskName: string): boolean;\r\n\r\n  /** 设定纸张大小 */\r\n  SET_PRINT_PAGESIZE(\r\n    intOrient: number,\r\n    PageWidth: number | string,\r\n    PageHeight: number | string,\r\n    strPageName: string,\r\n  ): void;\r\n\r\n  /** 增加超文本打印项(普通模式) */\r\n  ADD_PRINT_HTM(\r\n    Top: number | string,\r\n    Left: number | string,\r\n    Width: number | string,\r\n    Height: number | string,\r\n    strHtmlContent: string,\r\n  ): void;\r\n\r\n  /** 增加表格打印项（超文本模式）*/\r\n  ADD_PRINT_TABLE(\r\n    Top: number | string,\r\n    Left: number | string,\r\n    Width: number | string,\r\n    Height: number | string,\r\n    strHtml: string,\r\n  ): void;\r\n\r\n  /** 增加表格打印项（超文本模式）*/\r\n  ADD_PRINT_TABLE(\r\n    Top: number | string,\r\n    Left: number | string,\r\n    Width: number | string,\r\n    Height: number | string,\r\n    strHtml: string,\r\n  ): void;\r\n\r\n  /** 增加超文本打印项（URL模式）*/\r\n  ADD_PRINT_URL(\r\n    Top: number | string,\r\n    Left: number | string,\r\n    Width: number | string,\r\n    Height: number | string,\r\n    strURL: string,\r\n  ): void;\r\n\r\n  /** 增加纯文本打印项 */\r\n  ADD_PRINT_TEXT(\r\n    Top: number | string,\r\n    Left: number | string,\r\n    Width: number | string,\r\n    Height: number | string,\r\n    strContent: string,\r\n  ): void;\r\n\r\n  /** 增加图片打印项 */\r\n  ADD_PRINT_IMAGE(\r\n    Top: number | string,\r\n    Left: number | string,\r\n    Width: number | string,\r\n    Height: number | string,\r\n    strHtmlContent: string,\r\n  ): void;\r\n\r\n  /** 增加矩形线 */\r\n  ADD_PRINT_RECT(\r\n    Top: number | string,\r\n    Left: number | string,\r\n    Width: number | string,\r\n    Height: number | string,\r\n    intLineStyle: number,\r\n    intLineWidth: number,\r\n  ): void;\r\n\r\n  /** 增加椭圆线 */\r\n  ADD_PRINT_ELLIPSE(\r\n    Top: number | string,\r\n    Left: number | string,\r\n    Width: number | string,\r\n    Height: number | string,\r\n    intLineStyle: number,\r\n    intLineWidth: number,\r\n  ): void;\r\n\r\n  /** 增加直线 */\r\n  ADD_PRINT_LINE(\r\n    Top1: number | string,\r\n    Left1: number | string,\r\n    Top2: number | string,\r\n    Left2: number | string,\r\n    intLineStyle: number,\r\n    intLineWidth: number,\r\n  ): void;\r\n\r\n  /** 增加条形码 */\r\n  ADD_PRINT_BARCODE(\r\n    Top: number | string,\r\n    Left: number | string,\r\n    Width: number | string,\r\n    Height: number | string,\r\n    CodeType: string,\r\n    CodeValue: string,\r\n  ): void;\r\n\r\n  /** 增加图表 */\r\n  ADD_PRINT_CHART(\r\n    Top: number | string,\r\n    Left: number | string,\r\n    Width: number | string,\r\n    Height: number | string,\r\n    ChartType: number,\r\n    strHtml: string,\r\n  ): void;\r\n\r\n  /** 装载文档式模板 */\r\n  ADD_PRINT_DATA(strDataStyle: string, varDataValue: any): void;\r\n\r\n  /** 设置打印项风格 */\r\n  SET_PRINT_STYLE(\r\n    strStyleName: LodopStyleValue,\r\n    varStyleValue: number | string,\r\n  ): void;\r\n\r\n  /** 打印预览 */\r\n  PREVIEW(): number;\r\n\r\n  /** 直接打印 */\r\n  PRINT(): string;\r\n\r\n  /** 打印维护 */\r\n  PRINT_SETUP(): string;\r\n\r\n  /** 打印设计 */\r\n  PRINT_DESIGN(): string;\r\n\r\n  /** 强制分页 */\r\n  NEWPAGE(): boolean;\r\n\r\n  /** 获得打印设备个数 */\r\n  GET_PRINTER_COUNT(): number;\r\n\r\n  /** 获得打印设备名称 */\r\n  GET_PRINTER_NAME(strPrinterIDandType: number | string): string;\r\n\r\n  /** 指定打印设备 */\r\n  SET_PRINTER_INDEX(oIndexOrName: number | string): boolean;\r\n  /** 【CLodop】指定打印机 */\r\n  SET_PRINTER_INDEX(\r\n    DriverIndex: number | string,\r\n    PrinterIDandName: number | string,\r\n    SubDevIndex: number | string,\r\n  ): boolean;\r\n\r\n  /** 选择打印设备 */\r\n  SELECT_PRINTER(): number;\r\n\r\n  /** 设置显示模式 */\r\n  SET_SHOW_MODE(strModeType: string, varModeValue: number | string): boolean;\r\n\r\n  /** 设置打印模式 */\r\n  SET_PRINT_MODE(\r\n    strModeType: string,\r\n    varModeValue: number | string,\r\n  ): boolean | string;\r\n\r\n  /** 设置打印份数 */\r\n  SET_PRINT_COPIES(intCopies: number): boolean;\r\n\r\n  /** 设置预览窗口 */\r\n  SET_PREVIEW_WINDOW(\r\n    intDispMode: number,\r\n    intToolMode: number,\r\n    blDirectPrint: number,\r\n    inWidth: number,\r\n    intHeight: number,\r\n    strTitleButtonCaptoin: string,\r\n  ): void;\r\n\r\n  /** 指定背景图 */\r\n  ADD_PRINT_SETUP_BKIMG(strImgHtml: string): void;\r\n\r\n  /** 发送原始数据 */\r\n  SEND_PRINT_RAWDATA(strRawData: string): boolean;\r\n\r\n  /** 写端口数据 */\r\n  WRITE_PORT_DATA(strPortName: string, strData: string): boolean;\r\n\r\n  /** 读端口数据 */\r\n  READ_PORT_DATA(strPortName: string): string;\r\n\r\n  /** 获得配置文件名 */\r\n  GET_PRINT_INIFFNAME(strPrintTask: string): string;\r\n\r\n  /** 获得纸张类型名清单 */\r\n  GET_PAGESIZES_LIST(oPrinterName: number | string, strSplit: string): string;\r\n\r\n  /** 写本地文件内容 */\r\n  WRITE_FILE_TEXT(\r\n    intWriteMode: number | string,\r\n    strFileName: string,\r\n    strText: string,\r\n  ): string;\r\n\r\n  /** 读本地文件内容 */\r\n  GET_FILE_TEXT(strFileName: string): string | null;\r\n\r\n  /** 读本地文件时间 */\r\n  GET_FILE_TIME(strFileName: string): string | null;\r\n\r\n  /** 判断本地文件是否存在 */\r\n  IS_FILE_EXIST(strFileName: string): boolean;\r\n\r\n  /** 获得系统信息 */\r\n  GET_SYSTEM_INFO(strInfoType: string): boolean;\r\n\r\n  /** 获得数据值 */\r\n  GET_VALUE(ValueType: string, ValueIndex: number | string): any;\r\n\r\n  /** 数据格式转换 */\r\n  FORMAT(oType: string, oValue: any): any;\r\n\r\n  /** 获得对话框结果值 */\r\n  GET_DIALOG_VALUE(oType: string, oPreValue: string): string;\r\n\r\n  /** (增强型)打印初始化 */\r\n  PRINT_INITA(\r\n    Top: number | string,\r\n    Left: number | string,\r\n    Width: number | string,\r\n    Height: number | string,\r\n    strPrintName: string,\r\n  ): boolean;\r\n\r\n  /** (增强型)增加超文本打印项(图形模式) */\r\n  ADD_PRINT_HTML(\r\n    Top: number | string,\r\n    Left: number | string,\r\n    Width: number | string,\r\n    Height: number | string,\r\n    strHtmlContent: string,\r\n  ): void;\r\n\r\n  /** (增强型)增加表格打印项（URL模式） */\r\n  ADD_PRINT_TBURL(\r\n    Top: number | string,\r\n    Left: number | string,\r\n    Width: number | string,\r\n    Height: number | string,\r\n    strURL: string,\r\n  ): void;\r\n\r\n  /** (增强型)增加纯文本打印项 */\r\n  ADD_PRINT_TEXTA(\r\n    Top: number | string,\r\n    Left: number | string,\r\n    Width: number | string,\r\n    Height: number | string,\r\n    strContent: string,\r\n  ): void;\r\n\r\n  /** (增强型)设置打印项风格A, 继承 `SET_PRINT_STYLE` 的所有属性 */\r\n  SET_PRINT_STYLEA(\r\n    varItemNameID: number | string,\r\n    strStyleName: string,\r\n    varStyleValue: number | string,\r\n  ): void;\r\n\r\n  /** (增强型)导出数据到文件 */\r\n  SAVE_TO_FILE(strFileName: string): boolean;\r\n\r\n  /** (增强型)设置保存模式 */\r\n  SET_SAVE_MODE(varModeName: string, varModeValue: number | string): boolean;\r\n\r\n  /** (增强型)增加图形 */\r\n  ADD_PRINT_SHAPE(\r\n    intShapeType: number,\r\n    Top: number | string,\r\n    Left: number | string,\r\n    Width: number | string,\r\n    Height: number | string,\r\n    intLineStyle: number,\r\n    intLineWidth: number,\r\n    varColor: number | string,\r\n  ): void;\r\n\r\n  /** (增强型)指定打印设备 */\r\n  SET_PRINTER_INDEXA(oIndexOrName: number | string): boolean;\r\n\r\n  /** (增强型)强制分页 */\r\n  NEWPAGEA(): boolean;\r\n\r\n  /** (增强型)打印预览A */\r\n  PREVIEWA(): number;\r\n\r\n  /** (增强型)打印预览B */\r\n  PREVIEWB(): number;\r\n\r\n  /** 直接打印A */\r\n  PRINTA(): boolean;\r\n\r\n  /** 直接打印B */\r\n  PRINTB(): boolean;\r\n\r\n  /** 显示图表 */\r\n  SHOW_CHART(): void;\r\n\r\n  /** 控制界面动作 */\r\n  DO_ACTION(ActName: string, ActValue: number | string): void;\r\n\r\n  /**\r\n   * 设置软件产品注册信息\r\n   *\r\n   * @param  strCompanyName 注册单位名称，用途与控件参数CompanyName一样。\r\n   * @param  strLicense 主注册号，用途与控件参数License一样。\r\n   * @param  strLicenseA 附加注册号A，用途与控件参数LicenseA一样。\r\n   * @param  strLicenseB 附加注册号B，用途与控件参数LicenseB一样。\r\n   */\r\n  SET_LICENSES(\r\n    strCompanyName: string,\r\n    strLicense: string,\r\n    strLicenseA?: string,\r\n    strLicenseB?: string,\r\n  ): void;\r\n\r\n  webskt: WebSocket;\r\n}\r\n\r\nexport type LodopStyleValue =\r\n  | 'FontName'\r\n  | 'FontSize'\r\n  | 'FontColor'\r\n  | 'Bold'\r\n  | 'Italic'\r\n  | 'Underline'\r\n  | 'Alignment'\r\n  | 'Angle'\r\n  | 'ItemType'\r\n  | 'HOrient'\r\n  | 'VOrient'\r\n  | 'PenWidth'\r\n  | 'PenStyle'\r\n  | 'Stretch'\r\n  | 'PreviewOnly'\r\n  | 'ReadOnly';\r\n\r\nexport interface LodopResult {\r\n  /** 是否成功 */\r\n  ok: boolean;\r\n  /** 错误码 */\r\n  status?: string;\r\n  /** 成功时携带 LODOP 对象 */\r\n  lodop?: Lodop;\r\n  /** 错误信息 */\r\n  error?: any;\r\n}\r\n\r\nexport interface LodopPrintResult {\r\n  /** 是否成功 */\r\n  ok: boolean;\r\n  /** 错误信息 */\r\n  error?: string;\r\n  /** 代码 */\r\n  code: string;\r\n  /** 动态参数上下文对象 */\r\n  item: any;\r\n  /** 代码解析表达式 */\r\n  parser?: RegExp;\r\n}\r\n"]}