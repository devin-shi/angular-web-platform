/**
 * @license ng-alain(cipchk@qq.com) v1.0.0-beta.10
 * (c) 2018 Cipchk http://ng-alain.com/
 * License: MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common/http"),require("rxjs/Observable"),require("rxjs/observable/of"),require("rxjs/operators")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/common/http","rxjs/Observable","rxjs/observable/of","rxjs/operators"],t):t((e.delon=e.delon||{},e.delon.mock={}),e.ng.core,e.ng.common.http,e.Rx,e.Rx.Observable,e.Rx.Observable.prototype)}(this,function(e,r,u,l,p,f){"use strict";var h=function(e,t){this.status=e,this.error=t},d=function(){function e(){this.delay=300,this.force=!1,this.log=!0}return e.decorators=[{type:r.Injectable}],e}(),g=function(){function e(e){this.config=e,this.cached=[],this.applyMock(),delete this.config.data}return e.prototype.applyMock=function(){this.cached=[];try{this.realApplyMock()}catch(e){this.outputError(e)}},e.prototype.realApplyMock=function(){var a=this,e=this.config.data;e&&(Object.keys(e).forEach(function(n){var c=e[n];c&&Object.keys(c).forEach(function(e){var t=c[e];if("function"!=typeof t&&"object"!=typeof t&&"string"!=typeof t)throw Error("mock value of ["+n+"-"+e+"] should be function or object or string, but got "+typeof t);var r=a.genRule(e,t);if(-1===["GET","POST","PUT","HEAD","DELETE","PATCH","OPTIONS"].indexOf(r.method))throw Error("method of "+n+"-"+e+" is not valid");var o=a.cached.find(function(e){return e.url===r.url&&e.method===r.method});o?o.callback=r.callback:a.cached.push(r)})}),this.cached.sort(function(e,t){return(t.martcher||"").toString().length-(e.martcher||"").toString().length}))},e.prototype.genRule=function(e,t){var r="GET",o=e;if(-1<e.indexOf(" ")){var n=e.split(" ");r=n[0].toLowerCase(),o=n[1]}var c=null,a=[];if(~o.indexOf(":")){a=o.split("/").filter(function(e){return e.startsWith(":")}).map(function(e){return e.substring(1)});var s=o.split("/").map(function(e){return e.startsWith(":")?"([^/]+)":e}).join("/");c=new RegExp(s,"i")}else/(\([^)]+\))/i.test(o)&&(c=new RegExp(o,"i"));return{url:o,martcher:c,segments:a,callback:t,method:r.toUpperCase()}},e.prototype.outputError=function(e){var t=e.message.split(": ")[0],r=e.stack.split("\n").filter(function(e){return 0!==e.trim().indexOf("at ")}).map(function(e){return e.replace(t+": ","")});throw r.splice(1,0,[""]),console.group(),console.warn("==========Failed to parse mock config.=========="),console.log(r.join("\n")),console.groupEnd(),e},e.prototype.getRule=function(t,r){t=(t||"GET").toUpperCase();var o={},n=this.cached.find(function(e){return e.method===t&&(e.martcher?e.martcher.test(r):e.url===r)})||null;if(!n)return null;n.martcher&&n.martcher.exec(r).slice(1).map(function(e,t){o[n.segments[t]]=e});return{url:r,method:n.method,params:o,callback:n.callback}},e.prototype.clearCache=function(){this.cached=[]},Object.defineProperty(e.prototype,"rules",{get:function(){return this.cached},enumerable:!0,configurable:!0}),e.prototype.ngOnDestroy=function(){this.clearCache()},e.decorators=[{type:r.Injectable}],e.ctorParameters=function(){return[{type:d}]},e}(),o=function(){function e(e){this.injector=e}return e.prototype.intercept=function(t,e){var r,o=this.injector.get(g),n=Object.assign({delay:300,force:!1,log:!0},this.injector.get(d,null)),c=o.getRule(t.method,t.url);if(!c&&!n.force)return e.handle(t);switch(typeof c.callback){case"function":var a={original:t,body:t.body,queryString:{},headers:{},params:c.params};t.params.keys().forEach(function(e){return a.queryString[e]=t.params.get(e)}),t.headers.keys().forEach(function(e){return a.headers[e]=t.headers.get(e)});try{r=c.callback.call(this,a)}catch(e){var s;return e instanceof h?(s=new u.HttpErrorResponse({url:t.url,headers:t.headers,status:e.status,statusText:e.statusText||"Unknown Error",error:e.error}),n.log&&console.log("%c ðŸ‘½MOCK "+e.status+" STATUS ","background:#000;color:#bada55",t.url,s,t)):console.error("Please use MockStatusError to throw status error",e,t),new l.Observable(function(e){e.error(s)})}break;default:r=c.callback}var i=new u.HttpResponse({status:200,body:r,url:t.url});return n.log&&console.log("%c ðŸ‘½MOCK ","background:#000;color:#bada55",t.url,i,t),p.of(i).pipe(f.delay(n.delay))},e.decorators=[{type:r.Injectable}],e.ctorParameters=function(){return[{type:r.Injector}]},e}(),t=function(){function t(){}return t.forRoot=function(e){return{ngModule:t,providers:[g,{provide:d,useValue:e},{provide:u.HTTP_INTERCEPTORS,useClass:o,multi:!0}]}},t.decorators=[{type:r.NgModule,args:[{}]}],t}();e.MockStatusError=h,e.MockService=g,e.MockInterceptor=o,e.DelonMockConfig=d,e.DelonMockModule=t,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=mock.umd.min.js.map
