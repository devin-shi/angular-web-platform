import { Component, Input, ElementRef, EventEmitter, Output, NgZone, ViewEncapsulation } from '@angular/core';
import { LoaderService } from './loader.service';
import { AqmConfig } from './aqm.config';
var AqmPanoramaComponent = (function () {
    function AqmPanoramaComponent(el, COG, loader, zone) {
        this.el = el;
        this.COG = COG;
        this.loader = loader;
        this.zone = zone;
        this.options = {};
        this.ready = new EventEmitter();
        this.map = null;
    }
    AqmPanoramaComponent.prototype.ngOnInit = function () {
        this._initMap();
    };
    AqmPanoramaComponent.prototype.ngOnChanges = function (changes) {
        if ('options' in changes)
            this._updateOptions();
    };
    AqmPanoramaComponent.prototype._initMap = function () {
        var _this = this;
        if (this.map)
            return;
        this.loader.load().then(function () {
            _this.zone.runOutsideAngular(function () {
                try {
                    _this.map = new qq.maps.Panorama(_this.el.nativeElement, _this.options);
                }
                catch (ex) {
                    console.warn('街景初始化失败', ex);
                }
            });
            _this.ready.emit(_this.map);
        }).catch(function (error) {
            console.warn('js加载失败', error);
        });
    };
    AqmPanoramaComponent.prototype._updateOptions = function () {
        this.options = Object.assign({}, this.COG.panoramaOptions, this.options);
        if (this.map) {
            this.map.setOptions(this.options);
        }
    };
    AqmPanoramaComponent.prototype.destroy = function () {
    };
    AqmPanoramaComponent.prototype.ngOnDestroy = function () {
        this.destroy();
    };
    AqmPanoramaComponent.decorators = [
        { type: Component, args: [{
                    selector: 'aqm-panorama',
                    template: "",
                    styles: ["\n        .angular-qq-maps-container { display:block; width:100%; height:100%; }\n    "],
                    host: {
                        '[class.angular-qq-maps-container]': 'true'
                    },
                    encapsulation: ViewEncapsulation.None
                },] },
    ];
    /** @nocollapse */
    AqmPanoramaComponent.ctorParameters = function () { return [
        { type: ElementRef, },
        { type: AqmConfig, },
        { type: LoaderService, },
        { type: NgZone, },
    ]; };
    AqmPanoramaComponent.propDecorators = {
        "options": [{ type: Input },],
        "ready": [{ type: Output },],
    };
    return AqmPanoramaComponent;
}());
export { AqmPanoramaComponent };
//# sourceMappingURL=aqm-panorama.component.js.map